!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=66)}([function(t,e,n){(function(r){var i,o,s;s="object"==typeof self&&self.self===self&&self||"object"==typeof r&&r.global===r&&r,i=[n(2),n(4),e],void 0===(o=function(t,e,n){s.Backbone=function(t,e,n,r){var i=t.Backbone,o=Array.prototype.slice;e.VERSION="1.4.0",e.$=r,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s,a=e.Events={},u=/\s+/,c=function(t,e,r,i,o){var s,a=0;if(r&&"object"==typeof r){void 0!==i&&"context"in o&&void 0===o.context&&(o.context=i);for(s=n.keys(r);a<s.length;a++)e=c(t,e,s[a],r[s[a]],o)}else if(r&&u.test(r))for(s=r.split(u);a<s.length;a++)e=t(e,s[a],i,o);else e=t(e,r,i,o);return e};a.on=function(t,e,n){return this._events=c(l,this._events||{},t,e,{context:n,ctx:this,listening:s}),s&&((this._listeners||(this._listeners={}))[s.id]=s,s.interop=!1),this},a.listenTo=function(t,e,r){if(!t)return this;var i=t._listenId||(t._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),a=s=o[i];a||(this._listenId||(this._listenId=n.uniqueId("l")),a=s=o[i]=new m(this,t));var u=d(t,e,r,this);if(s=void 0,u)throw u;return a.interop&&a.on(e,r),this};var l=function(t,e,n,r){if(n){var i=t[e]||(t[e]=[]),o=r.context,s=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:o,ctx:o||s,listening:a})}return t},d=function(t,e,n,r){try{t.on(e,n,r)}catch(t){return t}};a.off=function(t,e,n){return this._events?(this._events=c(h,this._events,t,e,{context:n,listeners:this._listeners}),this):this},a.stopListening=function(t,e,r){var i=this._listeningTo;if(!i)return this;for(var o=t?[t._listenId]:n.keys(i),s=0;s<o.length;s++){var a=i[o[s]];if(!a)break;a.obj.off(e,r,this),a.interop&&a.off(e,r)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var h=function(t,e,r,i){if(t){var o,s=i.context,a=i.listeners,u=0;if(e||s||r){for(o=e?[e]:n.keys(t);u<o.length;u++){var c=t[e=o[u]];if(!c)break;for(var l=[],d=0;d<c.length;d++){var h=c[d];if(r&&r!==h.callback&&r!==h.callback._callback||s&&s!==h.context)l.push(h);else{var f=h.listening;f&&f.off(e,r)}}l.length?t[e]=l:delete t[e]}return t}for(o=n.keys(a);u<o.length;u++)a[o[u]].cleanup()}};a.once=function(t,e,n){var r=c(f,{},t,e,this.off.bind(this));return"string"==typeof t&&null==n&&(e=void 0),this.on(r,e,n)},a.listenToOnce=function(t,e,n){var r=c(f,{},e,n,this.stopListening.bind(this,t));return this.listenTo(t,r)};var f=function(t,e,r,i){if(r){var o=t[e]=n.once((function(){i(e,o),r.apply(this,arguments)}));o._callback=r}return t};a.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),r=0;r<e;r++)n[r]=arguments[r+1];return c(p,this._events,t,void 0,n),this};var p=function(t,e,n,r){if(t){var i=t[e],o=t.all;i&&o&&(o=o.slice()),i&&g(i,r),o&&g(o,[e].concat(r))}return t},g=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e);return}},m=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};m.prototype.on=a.on,m.prototype.off=function(t,e){var n;this.interop?(this._events=c(h,this._events,t,e,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=0===this.count),n&&this.cleanup()},m.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]},a.bind=a.on,a.unbind=a.off,n.extend(e,a);var y=e.Model=function(t,e){var r=t||{};e||(e={}),this.preinitialize.apply(this,arguments),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(r=this.parse(r,e)||{});var i=n.result(this,"defaults");r=n.defaults(n.extend({},i,r),i),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(y.prototype,a,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,r){if(null==t)return this;var i;if("object"==typeof t?(i=t,r=e):(i={})[t]=e,r||(r={}),!this._validate(i,r))return!1;var o=r.unset,s=r.silent,a=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={});var c=this.attributes,l=this.changed,d=this._previousAttributes;for(var h in i)e=i[h],n.isEqual(c[h],e)||a.push(h),n.isEqual(d[h],e)?delete l[h]:l[h]=e,o?delete c[h]:c[h]=e;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=r);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,c[a[f]],r)}if(u)return this;if(!s)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var r in this.attributes)e[r]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&n.clone(this.changed);var e,r=this._changing?this._previousAttributes:this.attributes,i={};for(var o in t){var s=t[o];n.isEqual(r[o],s)||(i[o]=s,e=!0)}return!!e&&i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,r=t.success;return t.success=function(n){var i=t.parse?e.parse(n,t):n;if(!e.set(i,t))return!1;r&&r.call(t.context,e,n,t),e.trigger("sync",e,n,t)},q(this,t),this.sync("read",this,t)},save:function(t,e,r){var i;null==t||"object"==typeof t?(i=t,r=e):(i={})[t]=e;var o=(r=n.extend({validate:!0,parse:!0},r)).wait;if(i&&!o){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var s=this,a=r.success,u=this.attributes;r.success=function(t){s.attributes=u;var e=r.parse?s.parse(t,r):t;if(o&&(e=n.extend({},i,e)),e&&!s.set(e,r))return!1;a&&a.call(r.context,s,t,r),s.trigger("sync",s,t,r)},q(this,r),i&&o&&(this.attributes=n.extend({},u,i));var c=this.isNew()?"create":r.patch?"patch":"update";"patch"!==c||r.attrs||(r.attrs=i);var l=this.sync(c,this,r);return this.attributes=u,l},destroy:function(t){t=t?n.clone(t):{};var e=this,r=t.success,i=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){i&&o(),r&&r.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var s=!1;return this.isNew()?n.defer(t.success):(q(this,t),s=this.sync("delete",this,t)),i||o(),s},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||L();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var r=this.validationError=this.validate(t,e)||null;return!r||(this.trigger("invalid",this,r,n.extend(e,{validationError:r})),!1)}});var v=e.Collection=function(t,e){e||(e={}),this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},b={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},_=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var r,i=Array(t.length-n),o=e.length;for(r=0;r<i.length;r++)i[r]=t[r+n];for(r=0;r<o;r++)t[r+n]=e[r];for(r=0;r<i.length;r++)t[r+o+n]=i[r]};n.extend(v.prototype,a,{model:y,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map((function(e){return e.toJSON(t)}))},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,w))},remove:function(t,e){e=n.extend({},e);var r=!n.isArray(t);t=r?[t]:t.slice();var i=this._removeModels(t,e);return!e.silent&&i.length&&(e.changes={added:[],merged:[],removed:i},this.trigger("update",this,e)),r?i[0]:i},set:function(t,e){if(null!=t){(e=n.extend({},b,e)).parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var r=!n.isArray(t);t=r?[t]:t.slice();var i=e.at;null!=i&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var o,s,a=[],u=[],c=[],l=[],d={},h=e.add,f=e.merge,p=e.remove,g=!1,m=this.comparator&&null==i&&!1!==e.sort,y=n.isString(this.comparator)?this.comparator:null;for(s=0;s<t.length;s++){o=t[s];var v=this.get(o);if(v){if(f&&o!==v){var w=this._isModel(o)?o.attributes:o;e.parse&&(w=v.parse(w,e)),v.set(w,e),c.push(v),m&&!g&&(g=v.hasChanged(y))}d[v.cid]||(d[v.cid]=!0,a.push(v)),t[s]=v}else h&&(o=t[s]=this._prepareModel(o,e))&&(u.push(o),this._addReference(o,e),d[o.cid]=!0,a.push(o))}if(p){for(s=0;s<this.length;s++)d[(o=this.models[s]).cid]||l.push(o);l.length&&this._removeModels(l,e)}var x=!1,C=!m&&h&&p;if(a.length&&C?(x=this.length!==a.length||n.some(this.models,(function(t,e){return t!==a[e]})),this.models.length=0,_(this.models,a,0),this.length=this.models.length):u.length&&(m&&(g=!0),_(this.models,u,null==i?this.length:i),this.length=this.models.length),g&&this.sort({silent:!0}),!e.silent){for(s=0;s<u.length;s++)null!=i&&(e.index=i+s),(o=u[s]).trigger("add",o,this,e);(g||x)&&this.trigger("sort",this,e),(u.length||l.length||c.length)&&(e.changes={added:u,removed:l,merged:c},this.trigger("update",this,e))}return r?t[0]:t}},reset:function(t,e){e=e?n.clone(e):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null!=t)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return t<0&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var r=e.length;return n.isFunction(e)&&(e=e.bind(this)),1===r||n.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){var e=(t=n.extend({parse:!0},t)).success,r=this;return t.success=function(n){var i=t.reset?"reset":"set";r[i](n,t),e&&e.call(t.context,r,n,t),r.trigger("sync",r,n,t)},q(this,t),this.sync("read",this,t)},create:function(t,e){var r=(e=e?n.clone(e):{}).wait;if(!(t=this._prepareModel(t,e)))return!1;r||this.add(t,e);var i=this,o=e.success;return e.success=function(t,e,n){r&&i.add(t,n),o&&o.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},values:function(){return new C(this,k)},keys:function(){return new C(this,R)},entries:function(){return new C(this,S)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;(e=e?n.clone(e):{}).collection=this;var r=new this.model(t,e);return r.validationError?(this.trigger("invalid",this,r.validationError,e),!1):r},_removeModels:function(t,e){for(var n=[],r=0;r<t.length;r++){var i=this.get(t[r]);if(i){var o=this.indexOf(i);this.models.splice(o,1),this.length--,delete this._byId[i.cid];var s=this.modelId(i.attributes);null!=s&&delete this._byId[s],e.silent||(e.index=o,i.trigger("remove",i,this,e)),n.push(i),this._removeReference(i,e)}}return n},_isModel:function(t){return t instanceof y},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){if(e){if(("add"===t||"remove"===t)&&n!==this)return;if("destroy"===t&&this.remove(e,r),"change"===t){var i=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);i!==o&&(null!=i&&delete this._byId[i],null!=o&&(this._byId[o]=e))}}this.trigger.apply(this,arguments)}});var x="function"==typeof Symbol&&Symbol.iterator;x&&(v.prototype[x]=v.prototype.values);var C=function(t,e){this._collection=t,this._kind=e,this._index=0},k=1,R=2,S=3;x&&(C.prototype[x]=function(){return this}),C.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t,e=this._collection.at(this._index);if(this._index++,this._kind===k)t=e;else{var n=this._collection.modelId(e.attributes);t=this._kind===R?n:[n,e]}return{value:t,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var I=e.View=function(t){this.cid=n.uniqueId("view"),this.preinitialize.apply(this,arguments),n.extend(this,n.pick(t,D)),this._ensureElement(),this.initialize.apply(this,arguments)},E=/^(\S+)\s*(.*)$/,D=["model","collection","el","id","attributes","className","tagName","events"];n.extend(I.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;for(var e in this.undelegateEvents(),t){var r=t[e];if(n.isFunction(r)||(r=this[r]),r){var i=e.match(E);this.delegate(i[1],i[2],r.bind(this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t.class=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});var A=function(t,e,r,i){n.each(r,(function(n,r){e[r]&&(t.prototype[r]=function(t,e,n,r){switch(e){case 1:return function(){return t[n](this[r])};case 2:return function(e){return t[n](this[r],e)};case 3:return function(e,i){return t[n](this[r],T(e,this),i)};case 4:return function(e,i,o){return t[n](this[r],T(e,this),i,o)};default:return function(){var e=o.call(arguments);return e.unshift(this[r]),t[n].apply(t,e)}}}(e,n,r,i))}))},T=function(t,e){return n.isFunction(t)?t:n.isObject(t)&&!e._isModel(t)?B(t):n.isString(t)?function(e){return e.get(t)}:t},B=function(t){var e=n.matches(t);return function(t){return e(t.attributes)}};n.each([[v,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"],[y,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes"]],(function(t){var e=t[0],r=t[1],i=t[2];e.mixin=function(t){var r=n.reduce(n.functions(t),(function(t,e){return t[e]=0,t}),{});A(e,t,r,i)},A(e,n,r,i)})),e.sync=function(t,r,i){var o=j[t];n.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(i.url||(s.url=n.result(r,"url")||L()),null!=i.data||!r||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",i.emulateJSON&&(s.data._method=o);var a=i.beforeSend;i.beforeSend=function(t){if(t.setRequestHeader("X-HTTP-Method-Override",o),a)return a.apply(this,arguments)}}"GET"===s.type||i.emulateJSON||(s.processData=!1);var u=i.error;i.error=function(t,e,n){i.textStatus=e,i.errorThrown=n,u&&u.call(i.context,t,e,n)};var c=i.xhr=e.ajax(n.extend(s,i));return r.trigger("request",r,c,i),c};var j={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var $=e.Router=function(t){t||(t={}),this.preinitialize.apply(this,arguments),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},G=/\((.*?)\)/g,P=/(\(\?)?:\w+/g,O=/\*\w+/g,N=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend($.prototype,a,{preinitialize:function(){},initialize:function(){},route:function(t,r,i){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var o=this;return e.history.route(t,(function(n){var s=o._extractParameters(t,n);!1!==o.execute(i,s,r)&&(o.trigger.apply(o,["route:"+r].concat(s)),o.trigger("route",r,s),e.history.trigger("route",o,r,s))})),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(N,"\\$&").replace(G,"(?:$1)?").replace(P,(function(t,e){return e?t:"([^/?]+)"})).replace(O,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return n.map(r,(function(t,e){return e===r.length-1?t||null:t?decodeURIComponent(t):null}))}});var F=e.History=function(){this.handlers=[],this.checkUrl=this.checkUrl.bind(this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},U=/^[#\/]|\s+$/g,M=/^\/+|\/+$/g,V=/#.*$/;F.started=!1,n.extend(F.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(U,"")},start:function(t){if(F.started)throw new Error("Backbone.history has already been started");if(F.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(M,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),F.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),n.some(this.handlers,(function(e){if(e.route.test(t))return e.callback(t),!0})))},navigate:function(t,e){if(!F.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;""!==t&&"?"!==t.charAt(0)||(n=n.slice(0,-1)||"/");var r=n+t;t=t.replace(V,"");var i=this.decodeFragment(t);if(this.fragment!==i){if(this.fragment=i,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var o=this.iframe.contentWindow;e.replace||(o.document.open(),o.document.close()),this._updateHash(o.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),e.history=new F,y.extend=v.extend=$.extend=I.extend=F.extend=function(t,e){var r,i=this;return r=t&&n.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},n.extend(r,i,e),r.prototype=n.create(i.prototype,t),r.prototype.constructor=r,r.__super__=i.prototype,r};var L=function(){throw new Error('A "url" property or function must be specified')},q=function(t,e){var n=e.error;e.error=function(r){n&&n.call(e.context,t,r,e),t.trigger("error",t,r,e)}};return e}(s,n,t,e)}.apply(e,i))||(t.exports=o)}).call(this,n(9))},function(t,e,n){"use strict";(function(t){n.d(e,"e",(function(){return r})),n.d(e,"p",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"o",(function(){return u})),n.d(e,"q",(function(){return c})),n.d(e,"s",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"r",(function(){return h})),n.d(e,"k",(function(){return f})),n.d(e,"m",(function(){return p})),n.d(e,"j",(function(){return g})),n.d(e,"l",(function(){return m})),n.d(e,"g",(function(){return y})),n.d(e,"f",(function(){return v})),n.d(e,"h",(function(){return b})),n.d(e,"n",(function(){return w})),n.d(e,"b",(function(){return _}));var r="1.11.0",i="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||Function("return this")()||{},o=Array.prototype,s=Object.prototype,a="undefined"!=typeof Symbol?Symbol.prototype:null,u=o.push,c=o.slice,l=s.toString,d=s.hasOwnProperty,h="undefined"!=typeof ArrayBuffer,f=Array.isArray,p=Object.keys,g=Object.create,m=h&&ArrayBuffer.isView,y=isNaN,v=isFinite,b=!{toString:null}.propertyIsEnumerable("toString"),w=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],_=Math.pow(2,53)-1}).call(this,n(9))},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return sn})),n.d(e,"VERSION",(function(){return i.e})),n.d(e,"restArguments",(function(){return o})),n.d(e,"isObject",(function(){return s})),n.d(e,"isNull",(function(){return a})),n.d(e,"isUndefined",(function(){return u})),n.d(e,"isBoolean",(function(){return c})),n.d(e,"isElement",(function(){return l})),n.d(e,"isString",(function(){return h})),n.d(e,"isNumber",(function(){return f})),n.d(e,"isDate",(function(){return p})),n.d(e,"isRegExp",(function(){return g})),n.d(e,"isError",(function(){return m})),n.d(e,"isSymbol",(function(){return y})),n.d(e,"isMap",(function(){return v})),n.d(e,"isWeakMap",(function(){return b})),n.d(e,"isSet",(function(){return w})),n.d(e,"isWeakSet",(function(){return _})),n.d(e,"isArrayBuffer",(function(){return x})),n.d(e,"isDataView",(function(){return C})),n.d(e,"isArray",(function(){return k})),n.d(e,"isFunction",(function(){return I})),n.d(e,"isArguments",(function(){return A})),n.d(e,"isFinite",(function(){return T})),n.d(e,"isNaN",(function(){return B})),n.d(e,"isTypedArray",(function(){return F})),n.d(e,"isEmpty",(function(){return q})),n.d(e,"isMatch",(function(){return z})),n.d(e,"isEqual",(function(){return W})),n.d(e,"keys",(function(){return L})),n.d(e,"allKeys",(function(){return X})),n.d(e,"values",(function(){return Y})),n.d(e,"pairs",(function(){return J})),n.d(e,"invert",(function(){return K})),n.d(e,"functions",(function(){return Z})),n.d(e,"methods",(function(){return Z})),n.d(e,"extend",(function(){return et})),n.d(e,"extendOwn",(function(){return nt})),n.d(e,"assign",(function(){return nt})),n.d(e,"defaults",(function(){return rt})),n.d(e,"create",(function(){return ot})),n.d(e,"clone",(function(){return st})),n.d(e,"tap",(function(){return at})),n.d(e,"has",(function(){return ut})),n.d(e,"mapObject",(function(){return yt})),n.d(e,"identity",(function(){return ct})),n.d(e,"constant",(function(){return j})),n.d(e,"noop",(function(){return vt})),n.d(e,"property",(function(){return ht})),n.d(e,"propertyOf",(function(){return bt})),n.d(e,"matcher",(function(){return lt})),n.d(e,"matches",(function(){return lt})),n.d(e,"times",(function(){return wt})),n.d(e,"random",(function(){return _t})),n.d(e,"now",(function(){return xt})),n.d(e,"escape",(function(){return Rt})),n.d(e,"unescape",(function(){return St})),n.d(e,"templateSettings",(function(){return It})),n.d(e,"template",(function(){return Bt})),n.d(e,"result",(function(){return jt})),n.d(e,"uniqueId",(function(){return Gt})),n.d(e,"chain",(function(){return Pt})),n.d(e,"iteratee",(function(){return gt})),n.d(e,"partial",(function(){return Ft})),n.d(e,"bind",(function(){return Ut})),n.d(e,"bindAll",(function(){return Vt})),n.d(e,"memoize",(function(){return Lt})),n.d(e,"delay",(function(){return qt})),n.d(e,"defer",(function(){return zt})),n.d(e,"throttle",(function(){return Qt})),n.d(e,"debounce",(function(){return Ht})),n.d(e,"wrap",(function(){return Wt})),n.d(e,"negate",(function(){return Xt})),n.d(e,"compose",(function(){return Yt})),n.d(e,"after",(function(){return Jt})),n.d(e,"before",(function(){return Kt})),n.d(e,"once",(function(){return Zt})),n.d(e,"findKey",(function(){return te})),n.d(e,"findIndex",(function(){return ne})),n.d(e,"findLastIndex",(function(){return re})),n.d(e,"sortedIndex",(function(){return ie})),n.d(e,"indexOf",(function(){return se})),n.d(e,"lastIndexOf",(function(){return ae})),n.d(e,"find",(function(){return ue})),n.d(e,"detect",(function(){return ue})),n.d(e,"findWhere",(function(){return ce})),n.d(e,"each",(function(){return le})),n.d(e,"forEach",(function(){return le})),n.d(e,"map",(function(){return de})),n.d(e,"collect",(function(){return de})),n.d(e,"reduce",(function(){return fe})),n.d(e,"foldl",(function(){return fe})),n.d(e,"inject",(function(){return fe})),n.d(e,"reduceRight",(function(){return pe})),n.d(e,"foldr",(function(){return pe})),n.d(e,"filter",(function(){return ge})),n.d(e,"select",(function(){return ge})),n.d(e,"reject",(function(){return me})),n.d(e,"every",(function(){return ye})),n.d(e,"all",(function(){return ye})),n.d(e,"some",(function(){return ve})),n.d(e,"any",(function(){return ve})),n.d(e,"contains",(function(){return be})),n.d(e,"includes",(function(){return be})),n.d(e,"include",(function(){return be})),n.d(e,"invoke",(function(){return we})),n.d(e,"pluck",(function(){return _e})),n.d(e,"where",(function(){return xe})),n.d(e,"max",(function(){return Ce})),n.d(e,"min",(function(){return ke})),n.d(e,"shuffle",(function(){return Se})),n.d(e,"sample",(function(){return Re})),n.d(e,"sortBy",(function(){return Ie})),n.d(e,"groupBy",(function(){return De})),n.d(e,"indexBy",(function(){return Ae})),n.d(e,"countBy",(function(){return Te})),n.d(e,"partition",(function(){return Be})),n.d(e,"toArray",(function(){return $e})),n.d(e,"size",(function(){return Ge})),n.d(e,"pick",(function(){return Oe})),n.d(e,"omit",(function(){return Ne})),n.d(e,"first",(function(){return Ue})),n.d(e,"head",(function(){return Ue})),n.d(e,"take",(function(){return Ue})),n.d(e,"initial",(function(){return Fe})),n.d(e,"last",(function(){return Ve})),n.d(e,"rest",(function(){return Me})),n.d(e,"tail",(function(){return Me})),n.d(e,"drop",(function(){return Me})),n.d(e,"compact",(function(){return Le})),n.d(e,"flatten",(function(){return qe})),n.d(e,"without",(function(){return Qe})),n.d(e,"uniq",(function(){return He})),n.d(e,"unique",(function(){return He})),n.d(e,"union",(function(){return We})),n.d(e,"intersection",(function(){return Xe})),n.d(e,"difference",(function(){return ze})),n.d(e,"unzip",(function(){return Ye})),n.d(e,"transpose",(function(){return Ye})),n.d(e,"zip",(function(){return Je})),n.d(e,"object",(function(){return Ke})),n.d(e,"range",(function(){return Ze})),n.d(e,"chunk",(function(){return tn})),n.d(e,"mixin",(function(){return nn}));var r={};n.r(r),n.d(r,"VERSION",(function(){return i.e})),n.d(r,"restArguments",(function(){return o})),n.d(r,"isObject",(function(){return s})),n.d(r,"isNull",(function(){return a})),n.d(r,"isUndefined",(function(){return u})),n.d(r,"isBoolean",(function(){return c})),n.d(r,"isElement",(function(){return l})),n.d(r,"isString",(function(){return h})),n.d(r,"isNumber",(function(){return f})),n.d(r,"isDate",(function(){return p})),n.d(r,"isRegExp",(function(){return g})),n.d(r,"isError",(function(){return m})),n.d(r,"isSymbol",(function(){return y})),n.d(r,"isMap",(function(){return v})),n.d(r,"isWeakMap",(function(){return b})),n.d(r,"isSet",(function(){return w})),n.d(r,"isWeakSet",(function(){return _})),n.d(r,"isArrayBuffer",(function(){return x})),n.d(r,"isDataView",(function(){return C})),n.d(r,"isArray",(function(){return k})),n.d(r,"isFunction",(function(){return I})),n.d(r,"isArguments",(function(){return A})),n.d(r,"isFinite",(function(){return T})),n.d(r,"isNaN",(function(){return B})),n.d(r,"isTypedArray",(function(){return F})),n.d(r,"isEmpty",(function(){return q})),n.d(r,"isMatch",(function(){return z})),n.d(r,"isEqual",(function(){return W})),n.d(r,"keys",(function(){return L})),n.d(r,"allKeys",(function(){return X})),n.d(r,"values",(function(){return Y})),n.d(r,"pairs",(function(){return J})),n.d(r,"invert",(function(){return K})),n.d(r,"functions",(function(){return Z})),n.d(r,"methods",(function(){return Z})),n.d(r,"extend",(function(){return et})),n.d(r,"extendOwn",(function(){return nt})),n.d(r,"assign",(function(){return nt})),n.d(r,"defaults",(function(){return rt})),n.d(r,"create",(function(){return ot})),n.d(r,"clone",(function(){return st})),n.d(r,"tap",(function(){return at})),n.d(r,"has",(function(){return ut})),n.d(r,"mapObject",(function(){return yt})),n.d(r,"identity",(function(){return ct})),n.d(r,"constant",(function(){return j})),n.d(r,"noop",(function(){return vt})),n.d(r,"property",(function(){return ht})),n.d(r,"propertyOf",(function(){return bt})),n.d(r,"matcher",(function(){return lt})),n.d(r,"matches",(function(){return lt})),n.d(r,"times",(function(){return wt})),n.d(r,"random",(function(){return _t})),n.d(r,"now",(function(){return xt})),n.d(r,"escape",(function(){return Rt})),n.d(r,"unescape",(function(){return St})),n.d(r,"templateSettings",(function(){return It})),n.d(r,"template",(function(){return Bt})),n.d(r,"result",(function(){return jt})),n.d(r,"uniqueId",(function(){return Gt})),n.d(r,"chain",(function(){return Pt})),n.d(r,"iteratee",(function(){return gt})),n.d(r,"partial",(function(){return Ft})),n.d(r,"bind",(function(){return Ut})),n.d(r,"bindAll",(function(){return Vt})),n.d(r,"memoize",(function(){return Lt})),n.d(r,"delay",(function(){return qt})),n.d(r,"defer",(function(){return zt})),n.d(r,"throttle",(function(){return Qt})),n.d(r,"debounce",(function(){return Ht})),n.d(r,"wrap",(function(){return Wt})),n.d(r,"negate",(function(){return Xt})),n.d(r,"compose",(function(){return Yt})),n.d(r,"after",(function(){return Jt})),n.d(r,"before",(function(){return Kt})),n.d(r,"once",(function(){return Zt})),n.d(r,"findKey",(function(){return te})),n.d(r,"findIndex",(function(){return ne})),n.d(r,"findLastIndex",(function(){return re})),n.d(r,"sortedIndex",(function(){return ie})),n.d(r,"indexOf",(function(){return se})),n.d(r,"lastIndexOf",(function(){return ae})),n.d(r,"find",(function(){return ue})),n.d(r,"detect",(function(){return ue})),n.d(r,"findWhere",(function(){return ce})),n.d(r,"each",(function(){return le})),n.d(r,"forEach",(function(){return le})),n.d(r,"map",(function(){return de})),n.d(r,"collect",(function(){return de})),n.d(r,"reduce",(function(){return fe})),n.d(r,"foldl",(function(){return fe})),n.d(r,"inject",(function(){return fe})),n.d(r,"reduceRight",(function(){return pe})),n.d(r,"foldr",(function(){return pe})),n.d(r,"filter",(function(){return ge})),n.d(r,"select",(function(){return ge})),n.d(r,"reject",(function(){return me})),n.d(r,"every",(function(){return ye})),n.d(r,"all",(function(){return ye})),n.d(r,"some",(function(){return ve})),n.d(r,"any",(function(){return ve})),n.d(r,"contains",(function(){return be})),n.d(r,"includes",(function(){return be})),n.d(r,"include",(function(){return be})),n.d(r,"invoke",(function(){return we})),n.d(r,"pluck",(function(){return _e})),n.d(r,"where",(function(){return xe})),n.d(r,"max",(function(){return Ce})),n.d(r,"min",(function(){return ke})),n.d(r,"shuffle",(function(){return Se})),n.d(r,"sample",(function(){return Re})),n.d(r,"sortBy",(function(){return Ie})),n.d(r,"groupBy",(function(){return De})),n.d(r,"indexBy",(function(){return Ae})),n.d(r,"countBy",(function(){return Te})),n.d(r,"partition",(function(){return Be})),n.d(r,"toArray",(function(){return $e})),n.d(r,"size",(function(){return Ge})),n.d(r,"pick",(function(){return Oe})),n.d(r,"omit",(function(){return Ne})),n.d(r,"first",(function(){return Ue})),n.d(r,"head",(function(){return Ue})),n.d(r,"take",(function(){return Ue})),n.d(r,"initial",(function(){return Fe})),n.d(r,"last",(function(){return Ve})),n.d(r,"rest",(function(){return Me})),n.d(r,"tail",(function(){return Me})),n.d(r,"drop",(function(){return Me})),n.d(r,"compact",(function(){return Le})),n.d(r,"flatten",(function(){return qe})),n.d(r,"without",(function(){return Qe})),n.d(r,"uniq",(function(){return He})),n.d(r,"unique",(function(){return He})),n.d(r,"union",(function(){return We})),n.d(r,"intersection",(function(){return Xe})),n.d(r,"difference",(function(){return ze})),n.d(r,"unzip",(function(){return Ye})),n.d(r,"transpose",(function(){return Ye})),n.d(r,"zip",(function(){return Je})),n.d(r,"object",(function(){return Ke})),n.d(r,"range",(function(){return Ze})),n.d(r,"chunk",(function(){return tn})),n.d(r,"mixin",(function(){return nn})),n.d(r,"default",(function(){return rn}));var i=n(1);function o(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(i=0;i<e;i++)o[i]=arguments[i];return o[e]=r,t.apply(this,o)}}function s(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function a(t){return null===t}function u(t){return void 0===t}function c(t){return!0===t||!1===t||"[object Boolean]"===i.s.call(t)}function l(t){return!(!t||1!==t.nodeType)}function d(t){return function(e){return i.s.call(e)==="[object "+t+"]"}}var h=d("String"),f=d("Number"),p=d("Date"),g=d("RegExp"),m=d("Error"),y=d("Symbol"),v=d("Map"),b=d("WeakMap"),w=d("Set"),_=d("WeakSet"),x=d("ArrayBuffer"),C=d("DataView"),k=i.k||d("Array"),R=d("Function"),S=i.p.document&&i.p.document.childNodes;"object"!=typeof Int8Array&&"function"!=typeof S&&(R=function(t){return"function"==typeof t||!1});var I=R;function E(t,e){return null!=t&&i.i.call(t,e)}var D=d("Arguments");!function(){D(arguments)||(D=function(t){return E(t,"callee")})}();var A=D;function T(t){return!y(t)&&Object(i.f)(t)&&!isNaN(parseFloat(t))}function B(t){return f(t)&&Object(i.g)(t)}function j(t){return function(){return t}}function $(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=i.b}}function G(t){return function(e){return null==e?void 0:e[t]}}var P=G("byteLength"),O=$(P),N=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var F=i.r?function(t){return i.l?Object(i.l)(t)&&!C(t):O(t)&&N.test(i.s.call(t))}:j(!1),U=G("length"),M=$(U);function V(t,e){e=function(t){for(var e={},n=t.length,r=0;r<n;++r)e[t[r]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=i.n.length,r=t.constructor,o=I(r)&&r.prototype||i.c,s="constructor";for(E(t,s)&&!e.contains(s)&&e.push(s);n--;)(s=i.n[n])in t&&t[s]!==o[s]&&!e.contains(s)&&e.push(s)}function L(t){if(!s(t))return[];if(i.m)return Object(i.m)(t);var e=[];for(var n in t)E(t,n)&&e.push(n);return i.h&&V(t,e),e}function q(t){return null==t||(M(t)&&(k(t)||h(t)||A(t))?0===t.length:0===L(t).length)}function z(t,e){var n=L(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var s=n[o];if(e[s]!==i[s]||!(s in i))return!1}return!0}function Q(t){return t instanceof Q?t:this instanceof Q?void(this._wrapped=t):new Q(t)}function H(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&function t(e,n,r,o){e instanceof Q&&(e=e._wrapped);n instanceof Q&&(n=n._wrapped);var s=i.s.call(e);if(s!==i.s.call(n))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return i.d.valueOf.call(e)===i.d.valueOf.call(n);case"[object ArrayBuffer]":return t(new DataView(e),new DataView(n),r,o);case"[object DataView]":var a=P(e);if(a!==P(n))return!1;for(;a--;)if(e.getUint8(a)!==n.getUint8(a))return!1;return!0}if(F(e))return t(new DataView(e.buffer),new DataView(n.buffer),r,o);var u="[object Array]"===s;if(!u){if("object"!=typeof e||"object"!=typeof n)return!1;var c=e.constructor,l=n.constructor;if(c!==l&&!(I(c)&&c instanceof c&&I(l)&&l instanceof l)&&"constructor"in e&&"constructor"in n)return!1}o=o||[];var d=(r=r||[]).length;for(;d--;)if(r[d]===e)return o[d]===n;if(r.push(e),o.push(n),u){if((d=e.length)!==n.length)return!1;for(;d--;)if(!H(e[d],n[d],r,o))return!1}else{var h,f=L(e);if(d=f.length,L(n).length!==d)return!1;for(;d--;)if(h=f[d],!E(n,h)||!H(e[h],n[h],r,o))return!1}return r.pop(),o.pop(),!0}(t,e,n,r)}function W(t,e){return H(t,e)}function X(t){if(!s(t))return[];var e=[];for(var n in t)e.push(n);return i.h&&V(t,e),e}function Y(t){for(var e=L(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r}function J(t){for(var e=L(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r}function K(t){for(var e={},n=L(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e}function Z(t){var e=[];for(var n in t)I(t[n])&&e.push(n);return e.sort()}function tt(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],s=t(o),a=s.length,u=0;u<a;u++){var c=s[u];e&&void 0!==n[c]||(n[c]=o[c])}return n}}Q.VERSION=i.e,Q.prototype.value=function(){return this._wrapped},Q.prototype.valueOf=Q.prototype.toJSON=Q.prototype.value,Q.prototype.toString=function(){return String(this._wrapped)};var et=tt(X),nt=tt(L),rt=tt(X,!0);function it(t){if(!s(t))return{};if(i.j)return Object(i.j)(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function ot(t,e){var n=it(t);return e&&nt(n,e),n}function st(t){return s(t)?k(t)?t.slice():et({},t):t}function at(t,e){return e(t),t}function ut(t,e){if(!k(e))return E(t,e);for(var n=e.length,r=0;r<n;r++){var o=e[r];if(null==t||!i.i.call(t,o))return!1;t=t[o]}return!!n}function ct(t){return t}function lt(t){return t=nt({},t),function(e){return z(e,t)}}function dt(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0}function ht(t){return k(t)?function(e){return dt(e,t)}:G(t)}function ft(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}}function pt(t,e,n){return null==t?ct:I(t)?ft(t,e,n):s(t)&&!k(t)?lt(t):ht(t)}function gt(t,e){return pt(t,e,1/0)}function mt(t,e,n){return Q.iteratee!==gt?Q.iteratee(t,e):pt(t,e,n)}function yt(t,e,n){e=mt(e,n);for(var r=L(t),i=r.length,o={},s=0;s<i;s++){var a=r[s];o[a]=e(t[a],a,t)}return o}function vt(){}function bt(t){return null==t?function(){}:function(e){return k(e)?dt(t,e):t[e]}}function wt(t,e,n){var r=Array(Math.max(0,t));e=ft(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r}function _t(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}Q.iteratee=gt;var xt=Date.now||function(){return(new Date).getTime()};function Ct(t){var e=function(e){return t[e]},n="(?:"+L(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}}var kt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Rt=Ct(kt),St=Ct(K(kt)),It=Q.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Et=/(.)^/,Dt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},At=/\\|'|\r|\n|\u2028|\u2029/g;function Tt(t){return"\\"+Dt[t]}function Bt(t,e,n){!e&&n&&(e=n),e=rt({},e,Q.templateSettings);var r,i=RegExp([(e.escape||Et).source,(e.interpolate||Et).source,(e.evaluate||Et).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,(function(e,n,r,i,a){return s+=t.slice(o,a).replace(At,Tt),o=a+e.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?s+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),e})),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{r=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var a=function(t){return r.call(this,t,Q)},u=e.variable||"obj";return a.source="function("+u+"){\n"+s+"}",a}function jt(t,e,n){k(e)||(e=[e]);var r=e.length;if(!r)return I(n)?n.call(t):n;for(var i=0;i<r;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=n,i=r),t=I(o)?o.call(t):o}return t}var $t=0;function Gt(t){var e=++$t+"";return t?t+e:e}function Pt(t){var e=Q(t);return e._chain=!0,e}function Ot(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=it(t.prototype),a=t.apply(o,i);return s(a)?a:o}var Nt=o((function(t,e){var n=Nt.placeholder,r=function(){for(var i=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===n?arguments[i++]:e[a];for(;i<arguments.length;)s.push(arguments[i++]);return Ot(t,r,this,this,s)};return r}));Nt.placeholder=Q;var Ft=Nt,Ut=o((function(t,e,n){if(!I(t))throw new TypeError("Bind must be called on a function");var r=o((function(i){return Ot(t,r,e,this,n.concat(i))}));return r}));function Mt(t,e,n,r){if(r=r||[],e||0===e){if(e<=0)return r.concat(t)}else e=1/0;for(var i=r.length,o=0,s=U(t);o<s;o++){var a=t[o];if(M(a)&&(k(a)||A(a)))if(e>1)Mt(a,e-1,n,r),i=r.length;else for(var u=0,c=a.length;u<c;)r[i++]=a[u++];else n||(r[i++]=a)}return r}var Vt=o((function(t,e){var n=(e=Mt(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=Ut(t[r],t)}return t}));function Lt(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return E(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n}var qt=o((function(t,e,n){return setTimeout((function(){return t.apply(null,n)}),e)})),zt=Ft(qt,Q,1);function Qt(t,e,n){var r,i,o,s,a=0;n||(n={});var u=function(){a=!1===n.leading?0:xt(),r=null,s=t.apply(i,o),r||(i=o=null)},c=function(){var c=xt();a||!1!==n.leading||(a=c);var l=e-(c-a);return i=this,o=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),a=c,s=t.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(u,l)),s};return c.cancel=function(){clearTimeout(r),a=0,r=i=o=null},c}function Ht(t,e,n){var r,i,s=function(e,n){r=null,n&&(i=t.apply(e,n))},a=o((function(o){if(r&&clearTimeout(r),n){var a=!r;r=setTimeout(s,e),a&&(i=t.apply(this,o))}else r=qt(s,e,this,o);return i}));return a.cancel=function(){clearTimeout(r),r=null},a}function Wt(t,e){return Ft(e,t)}function Xt(t){return function(){return!t.apply(this,arguments)}}function Yt(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}}function Jt(t,e){return function(){if(--t<1)return e.apply(this,arguments)}}function Kt(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var Zt=Ft(Kt,2);function te(t,e,n){e=mt(e,n);for(var r,i=L(t),o=0,s=i.length;o<s;o++)if(e(t[r=i[o]],r,t))return r}function ee(t){return function(e,n,r){n=mt(n,r);for(var i=U(e),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(n(e[o],o,e))return o;return-1}}var ne=ee(1),re=ee(-1);function ie(t,e,n,r){for(var i=(n=mt(n,r,1))(e),o=0,s=U(t);o<s;){var a=Math.floor((o+s)/2);n(t[a])<i?o=a+1:s=a}return o}function oe(t,e,n){return function(r,o,s){var a=0,u=U(r);if("number"==typeof s)t>0?a=s>=0?s:Math.max(s+u,a):u=s>=0?Math.min(s+1,u):s+u+1;else if(n&&s&&u)return r[s=n(r,o)]===o?s:-1;if(o!=o)return(s=e(i.q.call(r,a,u),B))>=0?s+a:-1;for(s=t>0?a:u-1;s>=0&&s<u;s+=t)if(r[s]===o)return s;return-1}}var se=oe(1,ne,ie),ae=oe(-1,re);function ue(t,e,n){var r=(M(t)?ne:te)(t,e,n);if(void 0!==r&&-1!==r)return t[r]}function ce(t,e){return ue(t,lt(e))}function le(t,e,n){var r,i;if(e=ft(e,n),M(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=L(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t}function de(t,e,n){e=mt(e,n);for(var r=!M(t)&&L(t),i=(r||t).length,o=Array(i),s=0;s<i;s++){var a=r?r[s]:s;o[s]=e(t[a],a,t)}return o}function he(t){var e=function(e,n,r,i){var o=!M(e)&&L(e),s=(o||e).length,a=t>0?0:s-1;for(i||(r=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var u=o?o[a]:a;r=n(r,e[u],u,e)}return r};return function(t,n,r,i){var o=arguments.length>=3;return e(t,ft(n,i,4),r,o)}}var fe=he(1),pe=he(-1);function ge(t,e,n){var r=[];return e=mt(e,n),le(t,(function(t,n,i){e(t,n,i)&&r.push(t)})),r}function me(t,e,n){return ge(t,Xt(mt(e)),n)}function ye(t,e,n){e=mt(e,n);for(var r=!M(t)&&L(t),i=(r||t).length,o=0;o<i;o++){var s=r?r[o]:o;if(!e(t[s],s,t))return!1}return!0}function ve(t,e,n){e=mt(e,n);for(var r=!M(t)&&L(t),i=(r||t).length,o=0;o<i;o++){var s=r?r[o]:o;if(e(t[s],s,t))return!0}return!1}function be(t,e,n,r){return M(t)||(t=Y(t)),("number"!=typeof n||r)&&(n=0),se(t,e,n)>=0}var we=o((function(t,e,n){var r,i;return I(e)?i=e:k(e)&&(r=e.slice(0,-1),e=e[e.length-1]),de(t,(function(t){var o=i;if(!o){if(r&&r.length&&(t=dt(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)}))}));function _e(t,e){return de(t,ht(e))}function xe(t,e){return ge(t,lt(e))}function Ce(t,e,n){var r,i,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=M(t)?t:Y(t)).length;a<u;a++)null!=(r=t[a])&&r>o&&(o=r);else e=mt(e,n),le(t,(function(t,n,r){((i=e(t,n,r))>s||i===-1/0&&o===-1/0)&&(o=t,s=i)}));return o}function ke(t,e,n){var r,i,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=M(t)?t:Y(t)).length;a<u;a++)null!=(r=t[a])&&r<o&&(o=r);else e=mt(e,n),le(t,(function(t,n,r){((i=e(t,n,r))<s||i===1/0&&o===1/0)&&(o=t,s=i)}));return o}function Re(t,e,n){if(null==e||n)return M(t)||(t=Y(t)),t[_t(t.length-1)];var r=M(t)?st(t):Y(t),i=U(r);e=Math.max(Math.min(e,i),0);for(var o=i-1,s=0;s<e;s++){var a=_t(s,o),u=r[s];r[s]=r[a],r[a]=u}return r.slice(0,e)}function Se(t){return Re(t,1/0)}function Ie(t,e,n){var r=0;return e=mt(e,n),_e(de(t,(function(t,n,i){return{value:t,index:r++,criteria:e(t,n,i)}})).sort((function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index})),"value")}function Ee(t,e){return function(n,r,i){var o=e?[[],[]]:{};return r=mt(r,i),le(n,(function(e,i){var s=r(e,i,n);t(o,e,s)})),o}}var De=Ee((function(t,e,n){E(t,n)?t[n].push(e):t[n]=[e]})),Ae=Ee((function(t,e,n){t[n]=e})),Te=Ee((function(t,e,n){E(t,n)?t[n]++:t[n]=1})),Be=Ee((function(t,e,n){t[n?0:1].push(e)}),!0),je=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function $e(t){return t?k(t)?i.q.call(t):h(t)?t.match(je):M(t)?de(t,ct):Y(t):[]}function Ge(t){return null==t?0:M(t)?t.length:L(t).length}function Pe(t,e,n){return e in n}var Oe=o((function(t,e){var n={},r=e[0];if(null==t)return n;I(r)?(e.length>1&&(r=ft(r,e[1])),e=X(t)):(r=Pe,e=Mt(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var s=e[i],a=t[s];r(a,s,t)&&(n[s]=a)}return n})),Ne=o((function(t,e){var n,r=e[0];return I(r)?(r=Xt(r),e.length>1&&(n=e[1])):(e=de(Mt(e,!1,!1),String),r=function(t,n){return!be(e,n)}),Oe(t,r,n)}));function Fe(t,e,n){return i.q.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function Ue(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:Fe(t,t.length-e)}function Me(t,e,n){return i.q.call(t,null==e||n?1:e)}function Ve(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:Me(t,Math.max(0,t.length-e))}function Le(t){return ge(t,Boolean)}function qe(t,e){return Mt(t,e,!1)}var ze=o((function(t,e){return e=Mt(e,!0,!0),ge(t,(function(t){return!be(e,t)}))})),Qe=o((function(t,e){return ze(t,e)}));function He(t,e,n,r){c(e)||(r=n,n=e,e=!1),null!=n&&(n=mt(n,r));for(var i=[],o=[],s=0,a=U(t);s<a;s++){var u=t[s],l=n?n(u,s,t):u;e&&!n?(s&&o===l||i.push(u),o=l):n?be(o,l)||(o.push(l),i.push(u)):be(i,u)||i.push(u)}return i}var We=o((function(t){return He(Mt(t,!0,!0))}));function Xe(t){for(var e=[],n=arguments.length,r=0,i=U(t);r<i;r++){var o=t[r];if(!be(e,o)){var s;for(s=1;s<n&&be(arguments[s],o);s++);s===n&&e.push(o)}}return e}function Ye(t){for(var e=t&&Ce(t,U).length||0,n=Array(e),r=0;r<e;r++)n[r]=_e(t,r);return n}var Je=o(Ye);function Ke(t,e){for(var n={},r=0,i=U(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n}function Ze(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i}function tn(t,e){if(null==e||e<1)return[];for(var n=[],r=0,o=t.length;r<o;)n.push(i.q.call(t,r,r+=e));return n}function en(t,e){return t._chain?Q(e).chain():e}function nn(t){return le(Z(t),(function(e){var n=Q[e]=t[e];Q.prototype[e]=function(){var t=[this._wrapped];return i.o.apply(t,arguments),en(this,n.apply(Q,t))}})),Q}le(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=i.a[t];Q.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),en(this,n)}})),le(["concat","join","slice"],(function(t){var e=i.a[t];Q.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),en(this,t)}}));var rn=Q,on=nn(r);on._=on;var sn=on},function(t,e,n){
/*!
ICanHaz.js version 0.10.2 -- by @HenrikJoreteg
More info at: http://icanhazjs.com
*/
var r;r=function(){var t=Object.prototype.toString;Array.isArray=Array.isArray||function(e){return"[object Array]"==t.call(e)};var e,n,r,i=String.prototype.trim;i?e=function(t){return null==t?"":i.call(t)}:(/\S/.test(" ")?(n=/^[\s\xA0]+/,r=/[\s\xA0]+$/):(n=/^\s+/,r=/\s+$/),e=function(t){return null==t?"":t.toString().replace(n,"").replace(r,"")});var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},s={},a=function(){};return a.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(t,e,n,r){if(r||(this.context=e,this.buffer=[]),!this.includes("",t))return r?t:void this.send(t);t=this.render_pragmas(t);var i=this.render_section(t,e,n);if(!1===i&&(i=this.render_tags(t,e,n,r)),r)return i;this.sendLines(i)},send:function(t){""!==t&&this.buffer.push(t)},sendLines:function(t){if(t)for(var e=t.split("\n"),n=0;n<e.length;n++)this.send(e[n])},render_pragmas:function(t){if(!this.includes("%",t))return t;var e=this,n=this.getCachedRegex("render_pragmas",(function(t,e){return new RegExp(t+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+e,"g")}));return t.replace(n,(function(t,n,r){if(!e.pragmas_implemented[n])throw{message:"This implementation of mustache doesn't understand the '"+n+"' pragma"};if(e.pragmas[n]={},r){var i=r.split("=");e.pragmas[n][i[0]]=i[1]}return""}))},render_partial:function(t,n,r){if(t=e(t),!r||void 0===r[t])throw{message:"unknown_partial '"+t+"'"};return n&&"object"==typeof n[t]?this.render(r[t],n[t],r,!0):this.render(r[t],n,r,!0)},render_section:function(t,e,n){if(!this.includes("#",t)&&!this.includes("^",t))return!1;var r=this,i=this.getCachedRegex("render_section",(function(t,e){return new RegExp("^([\\s\\S]*?)"+t+"(\\^|\\#)\\s*(.+)\\s*"+e+"\n*([\\s\\S]*?)"+t+"\\/\\s*\\3\\s*"+e+"\\s*([\\s\\S]*)$","g")}));return t.replace(i,(function(t,i,o,s,a,u){var c,l=i?r.render_tags(i,e,n,!0):"",d=u?r.render(u,e,n,!0):"",h=r.find(s,e);return"^"===o?c=!h||Array.isArray(h)&&0===h.length?r.render(a,e,n,!0):"":"#"===o&&(c=Array.isArray(h)?r.map(h,(function(t){return r.render(a,r.create_context(t),n,!0)})).join(""):r.is_object(h)?r.render(a,r.create_context(h),n,!0):"function"==typeof h?h.call(e,a,(function(t){return r.render(t,e,n,!0)})):h?r.render(a,e,n,!0):""),l+c+d}))},render_tags:function(t,e,n,r){for(var i=this,s=function(){return i.getCachedRegex("render_tags",(function(t,e){return new RegExp(t+"(=|!|>|&|\\{|%)?([^#\\^]+?)\\1?"+e+"+","g")}))},a=s(),u=function(t,r,u){switch(r){case"!":return"";case"=":return i.set_delimiters(u),a=s(),"";case">":return i.render_partial(u,e,n);case"{":case"&":return i.find(u,e);default:return c=i.find(u,e),String(c).replace(/&(?!\w+;)|[<>"']/g,(function(t){return o[t]||t}))}var c},c=t.split("\n"),l=0;l<c.length;l++)c[l]=c[l].replace(a,u,this),r||this.send(c[l]);if(r)return c.join("\n")},set_delimiters:function(t){var e=t.split(" ");this.otag=this.escape_regex(e[0]),this.ctag=this.escape_regex(e[1])},escape_regex:function(t){if(!arguments.callee.sRE){var e=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+e.join("|\\")+")","g")}return t.replace(arguments.callee.sRE,"\\$1")},find:function(t,n){function r(t){return!1===t||0===t||t}var i;if((t=e(t)).match(/([a-z_]+)\./gi)){var o=this.walk_context(t,n);r(o)&&(i=o)}else r(n[t])?i=n[t]:r(this.context[t])&&(i=this.context[t]);return"function"==typeof i?i.apply(n):void 0!==i?i:""},walk_context:function(t,e){for(var n=t.split("."),r=null!=e[n[0]]?e:this.context,i=r[n.shift()];null!=i&&n.length>0;)r=i,i=i[n.shift()];return"function"==typeof i?i.apply(r):i},includes:function(t,e){return-1!=e.indexOf(this.otag+t)},create_context:function(t){if(this.is_object(t))return t;var e=".";this.pragmas["IMPLICIT-ITERATOR"]&&(e=this.pragmas["IMPLICIT-ITERATOR"].iterator);var n={};return n[e]=t,n},is_object:function(t){return t&&"object"==typeof t},map:function(t,e){if("function"==typeof t.map)return t.map(e);for(var n=[],r=t.length,i=0;i<r;i++)n.push(e(t[i]));return n},getCachedRegex:function(t,e){var n=s[this.otag];n||(n=s[this.otag]={});var r=n[this.ctag];r||(r=n[this.ctag]={});var i=r[t];return i||(i=r[t]=e(this.otag,this.ctag)),i}},{name:"mustache.js",version:"0.4.0",to_html:function(t,e,n,r){var i=new a;if(r&&(i.send=r),i.render(t,e||{},n),!r)return i.buffer.join("\n")}}}(),
/*!
  ICanHaz.js -- by @HenrikJoreteg
*/
function(){function n(t){return"".trim?t.trim():t.replace(/^\s+/,"").replace(/\s+$/,"")}var i={VERSION:"0.10.2",templates:{},$:"undefined"!=typeof window&&(window.jQuery||window.Zepto)||null,addTemplate:function(t,e){if("object"!=typeof t)i[t]?console.error("Invalid name: "+t+"."):i.templates[t]?console.error('Template "'+t+'  " exists'):(i.templates[t]=e,i[t]=function(e,o){e=e||{};var s=r.to_html(i.templates[t],e,i.templates);return i.$&&!o?i.$(n(s)):s});else for(var o in t)this.addTemplate(o,t[o])},clearAll:function(){for(var t in i.templates)delete i[t];i.templates={}},refresh:function(){i.clearAll(),i.grabTemplates()},grabTemplates:function(){var t,e,r,o=document.getElementsByTagName("script"),s=[];for(t=0,e=o.length;t<e;t++)(r=o[t])&&r.innerHTML&&r.id&&("text/html"===r.type||"text/x-icanhaz"===r.type)&&(i.addTemplate(r.id,n(r.innerHTML)),s.unshift(r));for(t=0,e=s.length;t<e;t++)s[t].parentNode.removeChild(s[t])}};t.exports&&(e=t.exports=i),e.ich=i,"undefined"!=typeof document&&(i.$?i.$((function(){i.grabTemplates()})):document.addEventListener("DOMContentLoaded",(function(){i.grabTemplates()}),!0))}()},function(t,e){t.exports=jQuery},function(t,e,n){var r,i=n(50),o=n(24),s=n(51),a=n(52),u=n(53);"undefined"!=typeof ArrayBuffer&&(r=n(54));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=c||l;e.protocol=3;var h=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=i(h),p={type:"error",data:"parser error"},g=n(55);function m(t,e,n){for(var r=new Array(t.length),i=a(t.length,n),o=function(t,n,i){e(n,(function(e,n){r[t]=n,i(e,r)}))},s=0;s<t.length;s++)o(s,t[s],i)}e.encodePacket=function(t,n,r,i){"function"==typeof n&&(i=n,n=!1),"function"==typeof r&&(i=r,r=null);var o=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=t.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=h[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}(t,n,i);if(void 0!==g&&o instanceof g)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);if(d)return function(t,n,r){if(!n)return e.encodeBase64Packet(t,r);var i=new FileReader;return i.onload=function(){e.encodePacket({type:t.type,data:i.result},n,!0,r)},i.readAsArrayBuffer(t.data)}(t,n,r);var i=new Uint8Array(1);i[0]=h[t.type];var o=new g([i.buffer,t.data]);return r(o)}(t,n,i);if(o&&o.base64)return function(t,n){var r="b"+e.packets[t.type]+t.data.data;return n(r)}(t,i);var s=h[t.type];return void 0!==t.data&&(s+=r?u.encode(String(t.data),{strict:!1}):String(t.data)),i(""+s)},e.encodeBase64Packet=function(t,n){var r,i="b"+e.packets[t.type];if(void 0!==g&&t.data instanceof g){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];n(i+t)},o.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),u=0;u<s.length;u++)a[u]=s[u];r=String.fromCharCode.apply(null,a)}return i+=btoa(r),n(i)},e.decodePacket=function(t,n,r){if(void 0===t)return p;if("string"==typeof t){if("b"===t.charAt(0))return e.decodeBase64Packet(t.substr(1),n);if(r&&!1===(t=function(t){try{t=u.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return p;var i=t.charAt(0);return Number(i)==i&&f[i]?t.length>1?{type:f[i],data:t.substring(1)}:{type:f[i]}:p}i=new Uint8Array(t)[0];var o=s(t,1);return g&&"blob"===n&&(o=new g([o])),{type:f[i],data:o}},e.decodeBase64Packet=function(t,e){var n=f[t.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:t.substr(1)}};var i=r.decode(t.substr(1));return"blob"===e&&g&&(i=new g([i])),{type:n,data:i}},e.encodePayload=function(t,n,r){"function"==typeof n&&(r=n,n=null);var i=o(t);if(n&&i)return g&&!d?e.encodePayloadAsBlob(t,r):e.encodePayloadAsArrayBuffer(t,r);if(!t.length)return r("0:");m(t,(function(t,r){e.encodePacket(t,!!i&&n,!1,(function(t){r(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return r(e.join(""))}))},e.decodePayload=function(t,n,r){if("string"!=typeof t)return e.decodePayloadAsBinary(t,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===t)return r(p,0,1);for(var o,s,a="",u=0,c=t.length;u<c;u++){var l=t.charAt(u);if(":"===l){if(""===a||a!=(o=Number(a)))return r(p,0,1);if(a!=(s=t.substr(u+1,o)).length)return r(p,0,1);if(s.length){if(i=e.decodePacket(s,n,!1),p.type===i.type&&p.data===i.data)return r(p,0,1);if(!1===r(i,u+o,c))return}u+=o,a=""}else a+=l}return""!==a?r(p,0,1):void 0},e.encodePayloadAsArrayBuffer=function(t,n){if(!t.length)return n(new ArrayBuffer(0));m(t,(function(t,n){e.encodePacket(t,!0,!0,(function(t){return n(null,t)}))}),(function(t,e){var r=e.reduce((function(t,e){var n;return t+(n="string"==typeof e?e.length:e.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),o=0;return e.forEach((function(t){var e="string"==typeof t,n=t;if(e){for(var r=new Uint8Array(t.length),s=0;s<t.length;s++)r[s]=t.charCodeAt(s);n=r.buffer}i[o++]=e?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);i[o++]=255;for(r=new Uint8Array(n),s=0;s<r.length;s++)i[o++]=r[s]})),n(i.buffer)}))},e.encodePayloadAsBlob=function(t,n){m(t,(function(t,n){e.encodePacket(t,!0,!0,(function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var r=new Uint8Array(t.length),i=0;i<t.length;i++)r[i]=t.charCodeAt(i);t=r.buffer,e[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,g){var a=new g([e.buffer,s.buffer,t]);n(null,a)}}))}),(function(t,e){return n(new g(e))}))},e.decodePayloadAsBinary=function(t,n,r){"function"==typeof n&&(r=n,n=null);for(var i=t,o=[];i.byteLength>0;){for(var a=new Uint8Array(i),u=0===a[0],c="",l=1;255!==a[l];l++){if(c.length>310)return r(p,0,1);c+=a[l]}i=s(i,2+c.length),c=parseInt(c);var d=s(i,0,c);if(u)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(t){var h=new Uint8Array(d);d="";for(l=0;l<h.length;l++)d+=String.fromCharCode(h[l])}o.push(d),i=s(i,c)}var f=o.length;o.forEach((function(t,i){r(e.decodePacket(t,n,!0),i,f)}))}},function(t,e,n){(function(r){function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(40)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))})),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())}).call(this,n(19))},function(t,e){t.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(r){function i(){var t;try{t=e.storage.debug}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t}(e=t.exports=n(56)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var n=this.useColors;if(t[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+t[0]+(n?"%c ":" ")+"+"+e.humanize(this.diff),!n)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))})),t.splice(o,0,r)},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=i,e.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(i())}).call(this,n(19))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(6)("socket.io-parser"),i=n(11),o=n(42),s=n(12),a=n(20);function u(){}e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=u,e.Decoder=d;var c=e.ERROR+'"encode error"';function l(t){var n=""+t.type;if(e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data){var i=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===i)return c;n+=i}return r("encoded %j as %s",t,n),n}function d(){this.reconstructor=null}function h(t){this.reconPack=t,this.buffers=[]}function f(t){return{type:e.ERROR,data:"parser error: "+t}}u.prototype.encode=function(t,n){(r("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)?function(t,e){o.removeBlobs(t,(function(t){var n=o.deconstructPacket(t),r=l(n.packet),i=n.buffers;i.unshift(r),e(i)}))}(t,n):n([l(t)])},i(d.prototype),d.prototype.add=function(t){var n;if("string"==typeof t)n=function(t){var n=0,i={type:Number(t.charAt(0))};if(null==e.types[i.type])return f("unknown packet type "+i.type);if(e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type){for(var o="";"-"!==t.charAt(++n)&&(o+=t.charAt(n),n!=t.length););if(o!=Number(o)||"-"!==t.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===t.charAt(n+1))for(i.nsp="";++n;){if(","===(u=t.charAt(n)))break;if(i.nsp+=u,n===t.length)break}else i.nsp="/";var a=t.charAt(n+1);if(""!==a&&Number(a)==a){for(i.id="";++n;){var u;if(null==(u=t.charAt(n))||Number(u)!=u){--n;break}if(i.id+=t.charAt(n),n===t.length)break}i.id=Number(i.id)}if(t.charAt(++n)){var c=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(n));if(!(!1!==c&&(i.type===e.ERROR||s(c))))return f("invalid payload");i.data=c}return r("decoded %s as %j",t,i),i}(t),e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type?(this.reconstructor=new h(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",n))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(43),i=n(44),o=n(45);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return c(this,t,e,n)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=a(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|f(e.length);return 0===(t=a(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?a(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function d(t,e){if(l(e),t=a(t,e<0?0:0|f(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function f(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return M(t).length;default:if(r)return U(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return I(this,e,n);case"latin1":case"binary":return E(this,e,n);case"base64":return R(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function m(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var d=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){d=!1;break}if(d)return o}return-1}function b(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function w(t,e,n,r){return V(U(e,t.length-n),t,n,r)}function _(t,e,n,r){return V(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return _(t,e,n,r)}function C(t,e,n,r){return V(M(e),t,n,r)}function k(t,e,n,r){return V(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function R(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return l(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return d(null,t)},u.allocUnsafeSlow=function(t){return d(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var s=t[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?S(this,0,t):g.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),d=0;d<a;++d)if(c[d]!==l[d]){o=c[d],s=l[d];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return x(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function E(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function D(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=F(t[o]);return i}function A(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function T(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function j(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function $(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function G(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(t,e,n,r,o){return o||G(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function O(t,e,n,r,o){return o||G(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||T(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||T(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||T(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||T(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||T(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||T(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||T(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||T(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||T(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||T(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):$(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):$(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):$(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):$(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return P(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return P(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return O(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return O(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:U(new u(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function F(t){return t<16?"0"+t.toString(16):t.toString(16)}function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function M(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(N,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(9))},function(t,e,n){var r=n(48),i=n(15);t.exports=function(t){var e=t.xdomain,n=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||r))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(t){}if(!e)try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}},function(t,e){t.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},function(t,e,n){var r=n(5),i=n(17);function o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=o,i(o.prototype),o.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},o.prototype.onPacket=function(t){this.emit("packet",t)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,n){function r(t){if(t)return function(t){for(var e in r.prototype)t[e]=r.prototype[e];return t}(t)}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},r.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var i=0;i<r.length;i++)if((n=r[i])===e||n.fn===e){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,e)}return this},r.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],l=!1,d=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&f())}function f(){if(!l){var t=a(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++d<e;)u&&u[d].run();d=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){(function(e){t.exports=function(t){return n&&e.isBuffer(t)||r&&(t instanceof ArrayBuffer||function(t){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer}(t))};var n="function"==typeof e&&"function"==typeof e.isBuffer,r="function"==typeof ArrayBuffer}).call(this,n(13).Buffer)},function(t,e,n){var r=n(46),i=n(27),o=n(11),s=n(10),a=n(28),u=n(29),c=n(6)("socket.io-client:manager"),l=n(26),d=n(64),h=Object.prototype.hasOwnProperty;function f(t,e){if(!(this instanceof f))return new f(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}t.exports=f,f.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},f.prototype.updateSocketIds=function(){for(var t in this.nsps)h.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},f.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},o(f.prototype),f.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},f.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},f.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(t,e){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=a(n,"open",(function(){i.onopen(),t&&t()})),s=a(n,"error",(function(e){if(c("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var u=this._timeout;c("connect attempt will timeout after %d",u),0===u&&o.destroy();var l=setTimeout((function(){c("connect attempt timed out after %d",u),o.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",u)}),u);this.subs.push({destroy:function(){clearTimeout(l)}})}return this.subs.push(o),this.subs.push(s),this},f.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(a(t,"data",u(this,"ondata"))),this.subs.push(a(t,"ping",u(this,"onping"))),this.subs.push(a(t,"pong",u(this,"onpong"))),this.subs.push(a(t,"error",u(this,"onerror"))),this.subs.push(a(t,"close",u(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",u(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(t){this.decoder.add(t)},f.prototype.ondecoded=function(t){this.emit("packet",t)},f.prototype.onerror=function(t){c("error",t),this.emitAll("error",t)},f.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new i(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",o),n.on("connect",(function(){n.id=r.generateId(t)})),this.autoConnect&&o()}function o(){~l(r.connecting,n)||r.connecting.push(n)}return n},f.prototype.destroy=function(t){var e=l(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},f.prototype.packet=function(t){c("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,(function(n){for(var r=0;r<n.length;r++)e.engine.write(n[r],t.options);e.encoding=!1,e.processPacketQueue()})))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},f.prototype.cleanup=function(){c("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(t){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();c("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout((function(){t.skipReconnect||(c("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(e){e?(c("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(c("reconnect success"),t.onreconnect())})))}),e);this.subs.push({destroy:function(){clearTimeout(n)}})}},f.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,n){var r=n(14),i=n(49),o=n(58),s=n(59);e.polling=function(t){var e=!1,n=!1,s=!1!==t.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),e=t.hostname!==location.hostname||u!==t.port,n=t.secure!==a}if(t.xdomain=e,t.xscheme=n,"open"in new r(t)&&!t.forceJSONP)return new i(t);if(!s)throw new Error("JSONP disabled");return new o(t)},e.websocket=s},function(t,e,n){var r=n(16),i=n(18),o=n(5),s=n(7),a=n(25),u=n(8)("engine.io-client:polling");t.exports=l;var c=null!=new(n(14))({xdomain:!1}).responseType;function l(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),r.call(this,t)}s(l,r),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(t){var e=this;function n(){u("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){u("pre-pause polling complete"),--r||n()}))),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){u("pre-pause writing complete"),--r||n()})))}else n()},l.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(t){var e=this;u("polling got data %s",t);o.decodePayload(t,this.socket.binaryType,(function(t,n,r){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var t=this;function e(){u("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},l.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};o.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,n)}))},l.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t}},function(t,e,n){(function(e){var r=n(12),i=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);t.exports=function t(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,a=n.length;i<a;i++)if(t(n[i]))return!0;return!1}if("function"==typeof e&&e.isBuffer&&e.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||o&&n instanceof Blob||s&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return t(n.toJSON(),!0);for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)&&t(n[u]))return!0;return!1}}).call(this,n(13).Buffer)},function(t,e,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={},s=0,a=0;function u(t){var e="";do{e=i[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function c(){var t=u(+new Date);return t!==r?(s=0,r=t):t+"."+u(s++)}for(;a<64;a++)o[i[a]]=a;c.encode=u,c.decode=function(t){var e=0;for(a=0;a<t.length;a++)e=64*e+o[t.charAt(a)];return e},t.exports=c},function(t,e){var n=[].indexOf;t.exports=function(t,e){if(n)return t.indexOf(e);for(var r=0;r<t.length;++r)if(t[r]===e)return r;return-1}},function(t,e,n){var r=n(10),i=n(11),o=n(62),s=n(28),a=n(29),u=n(6)("socket.io-client:socket"),c=n(63),l=n(24);t.exports=f;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=i.prototype.emit;function f(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[s(t,"open",a(this,"onopen")),s(t,"packet",a(this,"onpacket")),s(t,"close",a(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.reconnecting||this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var t=o(arguments);return t.unshift("message"),this.emit.apply(this,t),this},f.prototype.emit=function(t){if(d.hasOwnProperty(t))return h.apply(this,arguments),this;var e=o(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:l(e))?r.BINARY_EVENT:r.EVENT,data:e,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},f.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},f.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?c.encode(this.query):this.query;u("sending connect packet with query %s",t),this.packet({type:r.CONNECT,query:t})}else this.packet({type:r.CONNECT})},f.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},f.prototype.onpacket=function(t){var e=t.nsp===this.nsp,n=t.type===r.ERROR&&"/"===t.nsp;if(e||n)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},f.prototype.onevent=function(t){var e=t.data||[];u("emitting event %j",e),null!=t.id&&(u("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?h.apply(this,e):this.receiveBuffer.push(e)},f.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var i=o(arguments);u("sending ack %j",i),e.packet({type:l(i)?r.BINARY_ACK:r.ACK,id:t,data:i})}}},f.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(u("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)h.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(t){return this.flags.compress=t,this},f.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,e){t.exports=function(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}}},function(t,e){var n=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}},function(t,e,n){var r=n(38),i=n(10),o=n(21),s=n(6)("socket.io-client");t.exports=e=u;var a=e.managers={};function u(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,i=r(t),u=i.source,c=i.id,l=i.path,d=a[c]&&l in a[c].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||d?(s("ignoring socket cache for %s",u),n=o(u,e)):(a[c]||(s("new io instance for %s",u),a[c]=o(u,e)),n=a[c]),i.query&&!e.query&&(e.query=i.query),n.socket(i.path,e)}e.protocol=i.protocol,e.connect=u,e.Manager=n(21),e.Socket=n(27)},function(t,e){
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(t){if(t.support.touch="ontouchend"in document,t.support.touch){var e,n=t.ui.mouse.prototype,r=n._mouseInit,i=n._mouseDestroy;n._touchStart=function(t){!e&&this._mouseCapture(t.originalEvent.changedTouches[0])&&(e=!0,this._touchMoved=!1,o(t,"mouseover"),o(t,"mousemove"),o(t,"mousedown"))},n._touchMove=function(t){e&&(this._touchMoved=!0,o(t,"mousemove"))},n._touchEnd=function(t){e&&(o(t,"mouseup"),o(t,"mouseout"),this._touchMoved||o(t,"click"),e=!1)},n._mouseInit=function(){this.element.bind({touchstart:t.proxy(this,"_touchStart"),touchmove:t.proxy(this,"_touchMove"),touchend:t.proxy(this,"_touchEnd")}),r.call(this)},n._mouseDestroy=function(){this.element.unbind({touchstart:t.proxy(this,"_touchStart"),touchmove:t.proxy(this,"_touchMove"),touchend:t.proxy(this,"_touchEnd")}),i.call(this)}}function o(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var n=t.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(e,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(r)}}}(jQuery)},function(t,e,n){var r,i,o;!function(s){"use strict";i=[n(4)],void 0===(o="function"==typeof(r=function(t){var e=0;t.ajaxTransport("iframe",(function(n){var r,i,o;if(n.async)return{send:function(s,a){(r=t('<form style="display:none;"></form>')).attr("accept-charset",n.formAcceptCharset),o=/\?/.test(n.url)?"&":"?","DELETE"===n.type?(n.url=n.url+o+"_method=DELETE",n.type="POST"):"PUT"===n.type?(n.url=n.url+o+"_method=PUT",n.type="POST"):"PATCH"===n.type&&(n.url=n.url+o+"_method=PATCH",n.type="POST"),i=t('<iframe src="javascript:false;" name="iframe-transport-'+(e+=1)+'"></iframe>').bind("load",(function(){var e,o=t.isArray(n.paramName)?n.paramName:[n.paramName];i.unbind("load").bind("load",(function(){var e;try{if(!(e=i.contents()).length||!e[0].firstChild)throw new Error}catch(t){e=void 0}a(200,"success",{iframe:e}),t('<iframe src="javascript:false;"></iframe>').appendTo(r),window.setTimeout((function(){r.remove()}),0)})),r.prop("target",i.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&t.each(n.formData,(function(e,n){t('<input type="hidden"/>').prop("name",n.name).val(n.value).appendTo(r)})),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(e=n.fileInput.clone(),n.fileInput.after((function(t){return e[t]})),n.paramName&&n.fileInput.each((function(e){t(this).prop("name",o[e]||n.paramName)})),r.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),r.submit(),e&&e.length&&n.fileInput.each((function(n,r){var i=t(e[n]);t(r).prop("name",i.prop("name")),i.replaceWith(r)}))})),r.append(i).appendTo(document.body)},abort:function(){i&&i.unbind("load").prop("src","javascript".concat(":false;")),r&&r.remove()}}})),t.ajaxSetup({converters:{"iframe text":function(e){return e&&t(e[0].body).text()},"iframe json":function(e){return e&&t.parseJSON(t(e[0].body).text())},"iframe html":function(e){return e&&t(e[0].body).html()},"iframe xml":function(e){var n=e&&e[0];return n&&t.isXMLDoc(n)?n:t.parseXML(n.XMLDocument&&n.XMLDocument.xml||t(n.body).html())},"iframe script":function(e){return e&&t.globalEval(t(e[0].body).text())}}})})?r.apply(e,i):r)||(t.exports=o)}()},function(t,e,n){var r,i,o;!function(s){"use strict";i=[n(4),n(34)],void 0===(o="function"==typeof(r=function(t){function e(e){var n="dragover"===e;return function(r){r.dataTransfer=r.originalEvent&&r.originalEvent.dataTransfer;var i=r.dataTransfer;i&&-1!==t.inArray("Files",i.types)&&!1!==this._trigger(e,t.Event(e,{delegatedEvent:r}))&&(r.preventDefault(),n&&(i.dropEffect="copy"))}}t.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||t('<input type="file"/>').prop("disabled")),t.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),t.support.xhrFormDataFileUpload=!!window.FormData,t.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),t.widget("blueimp.fileupload",{options:{dropZone:t(document),pasteZone:void 0,fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,uniqueFilenames:void 0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(e,n){return e=this.messages[e]||e.toString(),n&&t.each(n,(function(t,n){e=e.replace("{"+t+"}",n)})),e},formData:function(t){return t.serializeArray()},add:function(e,n){if(e.isDefaultPrevented())return!1;(n.autoUpload||!1!==n.autoUpload&&t(this).fileupload("option","autoUpload"))&&n.process().done((function(){n.submit()}))},processData:!1,contentType:!1,cache:!1,timeout:0},_promisePipe:(n=t.fn.jquery.split("."),Number(n[0])>1||Number(n[1])>7?"then":"pipe"),_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:t.support.blobSlice&&function(){var t=this.slice||this.webkitSlice||this.mozSlice;return t.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,n){var r=t-this.timestamp;return(!this.bitrate||!n||r>n)&&(this.bitrate=(e-this.loaded)*(1e3/r)*8,this.loaded=e,this.timestamp=t),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&t.support.xhrFileUpload||t.support.xhrFormDataFileUpload)},_getFormData:function(e){var n;return"function"===t.type(e.formData)?e.formData(e.form):t.isArray(e.formData)?e.formData:"object"===t.type(e.formData)?(n=[],t.each(e.formData,(function(t,e){n.push({name:t,value:e})})),n):[]},_getTotal:function(e){var n=0;return t.each(e,(function(t,e){n+=e.size||1})),n},_initProgressObject:function(e){var n={loaded:0,total:0,bitrate:0};e._progress?t.extend(e._progress,n):e._progress=n},_initResponseObject:function(t){var e;if(t._response)for(e in t._response)Object.prototype.hasOwnProperty.call(t._response,e)&&delete t._response[e];else t._response={}},_onProgress:function(e,n){if(e.lengthComputable){var r,i=Date.now?Date.now():(new Date).getTime();if(n._time&&n.progressInterval&&i-n._time<n.progressInterval&&e.loaded!==e.total)return;n._time=i,r=Math.floor(e.loaded/e.total*(n.chunkSize||n._progress.total))+(n.uploadedBytes||0),this._progress.loaded+=r-n._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,n.bitrateInterval),n._progress.loaded=n.loaded=r,n._progress.bitrate=n.bitrate=n._bitrateTimer.getBitrate(i,r,n.bitrateInterval),this._trigger("progress",t.Event("progress",{delegatedEvent:e}),n),this._trigger("progressall",t.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(e){var n=this,r=e.xhr?e.xhr():t.ajaxSettings.xhr();r.upload&&(t(r.upload).on("progress",(function(t){var r=t.originalEvent;t.lengthComputable=r.lengthComputable,t.loaded=r.loaded,t.total=r.total,n._onProgress(t,e)})),e.xhr=function(){return r})},_deinitProgressListener:function(e){var n=e.xhr?e.xhr():t.ajaxSettings.xhr();n.upload&&t(n.upload).off("progress")},_isInstanceOf:function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},_getUniqueFilename:function(t,e){return e[t=String(t)]?(t=t.replace(/(?: \(([\d]+)\))?(\.[^.]+)?$/,(function(t,e,n){return" ("+(e?Number(e)+1:1)+")"+(n||"")})),this._getUniqueFilename(t,e)):(e[t]=!0,t)},_initXHRData:function(e){var n,r=this,i=e.files[0],o=e.multipart||!t.support.xhrFileUpload,s="array"===t.type(e.paramName)?e.paramName[0]:e.paramName;e.headers=t.extend({},e.headers),e.contentRange&&(e.headers["Content-Range"]=e.contentRange),o&&!e.blob&&this._isInstanceOf("File",i)||(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(i.uploadName||i.name)+'"'),o?t.support.xhrFormDataFileUpload&&(e.postMessage?(n=this._getFormData(e),e.blob?n.push({name:s,value:e.blob}):t.each(e.files,(function(r,i){n.push({name:"array"===t.type(e.paramName)&&e.paramName[r]||s,value:i})}))):(r._isInstanceOf("FormData",e.formData)?n=e.formData:(n=new FormData,t.each(this._getFormData(e),(function(t,e){n.append(e.name,e.value)}))),e.blob?n.append(s,e.blob,i.uploadName||i.name):t.each(e.files,(function(i,o){if(r._isInstanceOf("File",o)||r._isInstanceOf("Blob",o)){var a=o.uploadName||o.name;e.uniqueFilenames&&(a=r._getUniqueFilename(a,e.uniqueFilenames)),n.append("array"===t.type(e.paramName)&&e.paramName[i]||s,o,a)}}))),e.data=n):(e.contentType=i.type||"application/octet-stream",e.data=e.blob||i),e.blob=null},_initIframeSettings:function(e){var n=t("<a></a>").prop("href",e.url).prop("host");e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&n&&n!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t)},_getParamName:function(e){var n=t(e.fileInput),r=e.paramName;return r?t.isArray(r)||(r=[r]):(r=[],n.each((function(){for(var e=t(this),n=e.prop("name")||"files[]",i=(e.prop("files")||[1]).length;i;)r.push(n),i-=1})),r.length||(r=[n.prop("name")||"files[]"])),r},_initFormSettings:function(e){e.form&&e.form.length||(e.form=t(e.fileInput.prop("form")),e.form.length||(e.form=t(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||"string"===t.type(e.form.prop("method"))&&e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var n=t.extend({},this.options,e);return this._initFormSettings(n),this._initDataSettings(n),n},_getDeferredState:function(t){return t.state?t.state():t.isResolved()?"resolved":t.isRejected()?"rejected":"pending"},_enhancePromise:function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},_getXHRPromise:function(e,n,r){var i=t.Deferred(),o=i.promise();return n=n||this.options.context||o,!0===e?i.resolveWith(n,r):!1===e&&i.rejectWith(n,r),o.abort=i.promise,this._enhancePromise(o)},_addConvenienceMethods:function(e,n){var r=this,i=function(e){return t.Deferred().resolveWith(r,e).promise()};n.process=function(e,o){return(e||o)&&(n._processQueue=this._processQueue=(this._processQueue||i([this]))[r._promisePipe]((function(){return n.errorThrown?t.Deferred().rejectWith(r,[n]).promise():i(arguments)}))[r._promisePipe](e,o)),this._processQueue||i([this])},n.submit=function(){return"pending"!==this.state()&&(n.jqXHR=this.jqXHR=!1!==r._trigger("submit",t.Event("submit",{delegatedEvent:e}),this)&&r._onSend(e,this)),this.jqXHR||r._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",r._trigger("fail",null,this),r._getXHRPromise(!1))},n.state=function(){return this.jqXHR?r._getDeferredState(this.jqXHR):this._processQueue?r._getDeferredState(this._processQueue):void 0},n.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===r._getDeferredState(this._processQueue)},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(t){var e=t.getResponseHeader("Range"),n=e&&e.split("-"),r=n&&n.length>1&&parseInt(n[1],10);return r&&r+1},_chunkedUpload:function(e,n){e.uploadedBytes=e.uploadedBytes||0;var r,i,o=this,s=e.files[0],a=s.size,u=e.uploadedBytes,c=e.maxChunkSize||a,l=this._blobSlice,d=t.Deferred(),h=d.promise();return!(!(this._isXHRUpload(e)&&l&&(u||("function"===t.type(c)?c(e):c)<a))||e.data)&&(!!n||(u>=a?(s.error=e.i18n("uploadedBytes"),this._getXHRPromise(!1,e.context,[null,"error",s.error])):(i=function(){var n=t.extend({},e),h=n._progress.loaded;n.blob=l.call(s,u,u+("function"===t.type(c)?c(n):c),s.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+u+"-"+(u+n.chunkSize-1)+"/"+a,o._trigger("chunkbeforesend",null,n),o._initXHRData(n),o._initProgressListener(n),r=(!1!==o._trigger("chunksend",null,n)&&t.ajax(n)||o._getXHRPromise(!1,n.context)).done((function(r,s,c){u=o._getUploadedBytes(c)||u+n.chunkSize,h+n.chunkSize-n._progress.loaded&&o._onProgress(t.Event("progress",{lengthComputable:!0,loaded:u-n.uploadedBytes,total:u-n.uploadedBytes}),n),e.uploadedBytes=n.uploadedBytes=u,n.result=r,n.textStatus=s,n.jqXHR=c,o._trigger("chunkdone",null,n),o._trigger("chunkalways",null,n),u<a?i():d.resolveWith(n.context,[r,s,c])})).fail((function(t,e,r){n.jqXHR=t,n.textStatus=e,n.errorThrown=r,o._trigger("chunkfail",null,n),o._trigger("chunkalways",null,n),d.rejectWith(n.context,[t,e,r])})).always((function(){o._deinitProgressListener(n)}))},this._enhancePromise(h),h.abort=function(){return r.abort()},i(),h)))},_beforeSend:function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(e),this._initProgressObject(e),e._progress.loaded=e.loaded=e.uploadedBytes||0,e._progress.total=e.total=this._getTotal(e.files)||1,e._progress.bitrate=e.bitrate=0,this._active+=1,this._progress.loaded+=e.loaded,this._progress.total+=e.total},_onDone:function(e,n,r,i){var o=i._progress.total,s=i._response;i._progress.loaded<o&&this._onProgress(t.Event("progress",{lengthComputable:!0,loaded:o,total:o}),i),s.result=i.result=e,s.textStatus=i.textStatus=n,s.jqXHR=i.jqXHR=r,this._trigger("done",null,i)},_onFail:function(t,e,n,r){var i=r._response;r.recalculateProgress&&(this._progress.loaded-=r._progress.loaded,this._progress.total-=r._progress.total),i.jqXHR=r.jqXHR=t,i.textStatus=r.textStatus=e,i.errorThrown=r.errorThrown=n,this._trigger("fail",null,r)},_onAlways:function(t,e,n,r){this._trigger("always",null,r)},_onSend:function(e,n){n.submit||this._addConvenienceMethods(e,n);var r,i,o,s,a=this,u=a._getAJAXSettings(n),c=function(){return a._sending+=1,u._bitrateTimer=new a._BitrateTimer,r=r||((i||!1===a._trigger("send",t.Event("send",{delegatedEvent:e}),u))&&a._getXHRPromise(!1,u.context,i)||a._chunkedUpload(u)||t.ajax(u)).done((function(t,e,n){a._onDone(t,e,n,u)})).fail((function(t,e,n){a._onFail(t,e,n,u)})).always((function(t,e,n){if(a._deinitProgressListener(u),a._onAlways(t,e,n,u),a._sending-=1,a._active-=1,u.limitConcurrentUploads&&u.limitConcurrentUploads>a._sending)for(var r=a._slots.shift();r;){if("pending"===a._getDeferredState(r)){r.resolve();break}r=a._slots.shift()}0===a._active&&a._trigger("stop")}))};return this._beforeSend(e,u),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=t.Deferred(),this._slots.push(o),s=o[a._promisePipe](c)):(this._sequence=this._sequence[a._promisePipe](c,c),s=this._sequence),s.abort=function(){return i=[void 0,"abort","abort"],r?r.abort():(o&&o.rejectWith(u.context,i),c())},this._enhancePromise(s)):c()},_onAdd:function(e,n){var r,i,o,s,a=this,u=!0,c=t.extend({},this.options,n),l=n.files,d=l.length,h=c.limitMultiFileUploads,f=c.limitMultiFileUploadSize,p=c.limitMultiFileUploadSizeOverhead,g=0,m=this._getParamName(c),y=0;if(!d)return!1;if(f&&void 0===l[0].size&&(f=void 0),(c.singleFileUploads||h||f)&&this._isXHRUpload(c))if(c.singleFileUploads||f||!h)if(!c.singleFileUploads&&f)for(o=[],r=[],s=0;s<d;s+=1)g+=l[s].size+p,(s+1===d||g+l[s+1].size+p>f||h&&s+1-y>=h)&&(o.push(l.slice(y,s+1)),(i=m.slice(y,s+1)).length||(i=m),r.push(i),y=s+1,g=0);else r=m;else for(o=[],r=[],s=0;s<d;s+=h)o.push(l.slice(s,s+h)),(i=m.slice(s,s+h)).length||(i=m),r.push(i);else o=[l],r=[m];return n.originalFiles=l,t.each(o||l,(function(i,s){var c=t.extend({},n);return c.files=o?s:[s],c.paramName=r[i],a._initResponseObject(c),a._initProgressObject(c),a._addConvenienceMethods(e,c),u=a._trigger("add",t.Event("add",{delegatedEvent:e}),c)})),u},_replaceFileInput:function(e){var n=e.fileInput,r=n.clone(!0),i=n.is(document.activeElement);e.fileInputClone=r,t("<form></form>").append(r)[0].reset(),n.after(r).detach(),i&&r.trigger("focus"),t.cleanData(n.off("remove")),this.options.fileInput=this.options.fileInput.map((function(t,e){return e===n[0]?r[0]:e})),n[0]===this.element[0]&&(this.element=r)},_handleFileTreeEntry:function(e,n){var r,i=this,o=t.Deferred(),s=[],a=function(t){t&&!t.entry&&(t.entry=e),o.resolve([t])},u=function(){r.readEntries((function(t){t.length?(s=s.concat(t),u()):function(t){i._handleFileTreeEntries(t,n+e.name+"/").done((function(t){o.resolve(t)})).fail(a)}(s)}),a)};return n=n||"",e.isFile?e._file?(e._file.relativePath=n,o.resolve(e._file)):e.file((function(t){t.relativePath=n,o.resolve(t)}),a):e.isDirectory?(r=e.createReader(),u()):o.resolve([]),o.promise()},_handleFileTreeEntries:function(e,n){var r=this;return t.when.apply(t,t.map(e,(function(t){return r._handleFileTreeEntry(t,n)})))[this._promisePipe]((function(){return Array.prototype.concat.apply([],arguments)}))},_getDroppedFiles:function(e){var n=(e=e||{}).items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(t.map(n,(function(t){var e;return t.webkitGetAsEntry?((e=t.webkitGetAsEntry())&&(e._file=t.getAsFile()),e):t.getAsEntry()}))):t.Deferred().resolve(t.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){var n,r,i=(e=t(e)).prop("webkitEntries")||e.prop("entries");if(i&&i.length)return this._handleFileTreeEntries(i);if((n=t.makeArray(e.prop("files"))).length)void 0===n[0].name&&n[0].fileName&&t.each(n,(function(t,e){e.name=e.fileName,e.size=e.fileSize}));else{if(!(r=e.prop("value")))return t.Deferred().resolve([]).promise();n=[{name:r.replace(/^.*\\/,"")}]}return t.Deferred().resolve(n).promise()},_getFileInputFiles:function(e){return e instanceof t&&1!==e.length?t.when.apply(t,t.map(e,this._getSingleFileInputFiles))[this._promisePipe]((function(){return Array.prototype.concat.apply([],arguments)})):this._getSingleFileInputFiles(e)},_onChange:function(e){var n=this,r={fileInput:t(e.target),form:t(e.target.form)};this._getFileInputFiles(r.fileInput).always((function(i){r.files=i,n.options.replaceFileInput&&n._replaceFileInput(r),!1!==n._trigger("change",t.Event("change",{delegatedEvent:e}),r)&&n._onAdd(e,r)}))},_onPaste:function(e){var n=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,r={files:[]};n&&n.length&&(t.each(n,(function(t,e){var n=e.getAsFile&&e.getAsFile();n&&r.files.push(n)})),!1!==this._trigger("paste",t.Event("paste",{delegatedEvent:e}),r)&&this._onAdd(e,r))},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var n=this,r=e.dataTransfer,i={};r&&r.files&&r.files.length&&(e.preventDefault(),this._getDroppedFiles(r).always((function(r){i.files=r,!1!==n._trigger("drop",t.Event("drop",{delegatedEvent:e}),i)&&n._onAdd(e,i)})))},_onDragOver:e("dragover"),_onDragEnter:e("dragenter"),_onDragLeave:e("dragleave"),_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave}),this._on(this.options.pasteZone,{paste:this._onPaste})),t.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_destroy:function(){this._destroyEventHandlers()},_setOption:function(e,n){var r=-1!==t.inArray(e,this._specialOptions);r&&this._destroyEventHandlers(),this._super(e,n),r&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof t||(e.fileInput=t(e.fileInput)),e.dropZone instanceof t||(e.dropZone=t(e.dropZone)),e.pasteZone instanceof t||(e.pasteZone=t(e.pasteZone))},_getRegExp:function(t){var e=t.split("/"),n=e.pop();return e.shift(),new RegExp(e.join("/"),n)},_isRegExpOption:function(e,n){return"url"!==e&&"string"===t.type(n)&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var e=this,n=this.options,r=this.element.data();t.each(this.element[0].attributes,(function(t,i){var o,s=i.name.toLowerCase();/^data-/.test(s)&&(s=s.slice(5).replace(/-[a-z]/g,(function(t){return t.charAt(1).toUpperCase()})),o=r[s],e._isRegExpOption(s,o)&&(o=e._getRegExp(o)),n[s]=o)}))},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(e){var n=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always((function(t){e.files=t,n._onAdd(null,e)})):(e.files=t.makeArray(e.files),this._onAdd(null,e)))},send:function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var n,r,i=this,o=t.Deferred(),s=o.promise();return s.abort=function(){return r=!0,n?n.abort():(o.reject(null,"abort","abort"),s)},this._getFileInputFiles(e.fileInput).always((function(t){r||(t.length?(e.files=t,(n=i._onSend(null,e)).then((function(t,e,n){o.resolve(t,e,n)}),(function(t,e,n){o.reject(t,e,n)}))):o.reject())})),this._enhancePromise(s)}if(e.files=t.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)}});var n})?r.apply(e,i):r)||(t.exports=o)}()},function(t,e,n){var r,i,o;
/*!
 * jQuery UI Widget 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */i=[n(4),n(35)],void 0===(o="function"==typeof(r=function(t){var e,n=0,r=Array.prototype.slice;return t.cleanData=(e=t.cleanData,function(n){var r,i,o;for(o=0;null!=(i=n[o]);o++)try{(r=t._data(i,"events"))&&r.remove&&t(i).triggerHandler("remove")}catch(t){}e(n)}),t.widget=function(e,n,r){var i,o,s,a={},u=e.split(".")[0],c=u+"-"+(e=e.split(".")[1]);return r||(r=n,n=t.Widget),t.isArray(r)&&(r=t.extend.apply(null,[{}].concat(r))),t.expr[":"][c.toLowerCase()]=function(e){return!!t.data(e,c)},t[u]=t[u]||{},i=t[u][e],o=t[u][e]=function(t,e){if(!this._createWidget)return new o(t,e);arguments.length&&this._createWidget(t,e)},t.extend(o,i,{version:r.version,_proto:t.extend({},r),_childConstructors:[]}),(s=new n).options=t.widget.extend({},s.options),t.each(r,(function(e,r){t.isFunction(r)?a[e]=function(){function t(){return n.prototype[e].apply(this,arguments)}function i(t){return n.prototype[e].apply(this,t)}return function(){var e,n=this._super,o=this._superApply;return this._super=t,this._superApply=i,e=r.apply(this,arguments),this._super=n,this._superApply=o,e}}():a[e]=r})),o.prototype=t.widget.extend(s,{widgetEventPrefix:i&&s.widgetEventPrefix||e},a,{constructor:o,namespace:u,widgetName:e,widgetFullName:c}),i?(t.each(i._childConstructors,(function(e,n){var r=n.prototype;t.widget(r.namespace+"."+r.widgetName,o,n._proto)})),delete i._childConstructors):n._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var n,i,o=r.call(arguments,1),s=0,a=o.length;s<a;s++)for(n in o[s])i=o[s][n],o[s].hasOwnProperty(n)&&void 0!==i&&(t.isPlainObject(i)?e[n]=t.isPlainObject(e[n])?t.widget.extend({},e[n],i):t.widget.extend({},i):e[n]=i);return e},t.widget.bridge=function(e,n){var i=n.prototype.widgetFullName||e;t.fn[e]=function(o){var s="string"==typeof o,a=r.call(arguments,1),u=this;return s?this.length||"instance"!==o?this.each((function(){var n,r=t.data(this,i);return"instance"===o?(u=r,!1):r?t.isFunction(r[o])&&"_"!==o.charAt(0)?(n=r[o].apply(r,a))!==r&&void 0!==n?(u=n&&n.jquery?u.pushStack(n.get()):n,!1):void 0:t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")})):u=void 0:(a.length&&(o=t.widget.extend.apply(null,[o].concat(a))),this.each((function(){var e=t.data(this,i);e?(e.option(o||{}),e._init&&e._init()):t.data(this,i,new n(o,this))}))),u}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,r){r=t(r||this.defaultElement||this)[0],this.element=t(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},r!==this&&(t.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===r&&this.destroy()}}),this.document=t(r.style?r.ownerDocument:r.document||r),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,(function(t,n){e._removeClass(n,t)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,n){var r,i,o,s=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(s={},r=e.split("."),e=r.shift(),r.length){for(i=s[e]=t.widget.extend({},this.options[e]),o=0;o<r.length-1;o++)i[r[o]]=i[r[o]]||{},i=i[r[o]];if(e=r.pop(),1===arguments.length)return void 0===i[e]?null:i[e];i[e]=n}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];s[e]=n}return this._setOptions(s),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var n,r,i;for(n in e)i=this.classesElementLookup[n],e[n]!==this.options.classes[n]&&i&&i.length&&(r=t(i.get()),this._removeClass(i,n),r.addClass(this._classes({element:r,keys:n,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){var n=[],r=this;function i(i,o){var s,a;for(a=0;a<i.length;a++)s=r.classesElementLookup[i[a]]||t(),s=e.add?t(t.unique(s.get().concat(e.element.get()))):t(s.not(e.element).get()),r.classesElementLookup[i[a]]=s,n.push(i[a]),o&&e.classes[i[a]]&&n.push(e.classes[i[a]])}return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),n.join(" ")},_untrackClassesElement:function(e){var n=this;t.each(n.classesElementLookup,(function(r,i){-1!==t.inArray(e.target,i)&&(n.classesElementLookup[r]=t(i.not(e.target).get()))}))},_removeClass:function(t,e,n){return this._toggleClass(t,e,n,!1)},_addClass:function(t,e,n){return this._toggleClass(t,e,n,!0)},_toggleClass:function(t,e,n,r){r="boolean"==typeof r?r:n;var i="string"==typeof t||null===t,o={extra:i?e:n,keys:i?t:e,element:i?this.element:t,add:r};return o.element.toggleClass(this._classes(o),r),this},_on:function(e,n,r){var i,o=this;"boolean"!=typeof e&&(r=n,n=e,e=!1),r?(n=i=t(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),t.each(r,(function(r,s){function a(){if(e||!0!==o.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof s?o[s]:s).apply(o,arguments)}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var u=r.match(/^([\w:-]*)\s*(.*)$/),c=u[1]+o.eventNamespace,l=u[2];l?i.on(c,l,a):n.on(c,a)}))},_off:function(e,n){n=(n||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(n).off(n),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var n=this;return setTimeout((function(){return("string"==typeof t?n[t]:t).apply(n,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,n,r){var i,o,s=this.options[e];if(r=r||{},(n=t.Event(n)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(i in o)i in n||(n[i]=o[i]);return this.element.trigger(n,r),!(t.isFunction(s)&&!1===s.apply(this.element[0],[n].concat(r))||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,n){t.Widget.prototype["_"+e]=function(r,i,o){var s;"string"==typeof i&&(i={effect:i});var a=i?!0===i||"number"==typeof i?n:i.effect||n:e;"number"==typeof(i=i||{})&&(i={duration:i}),s=!t.isEmptyObject(i),i.complete=o,i.delay&&r.delay(i.delay),s&&t.effects&&t.effects.effect[a]?r[e](i):a!==e&&r[a]?r[a](i.duration,i.easing,o):r.queue((function(n){t(this)[e](),o&&o.call(r[0]),n()}))}})),t.widget})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){var r,i,o;i=[n(4)],void 0===(o="function"==typeof(r=function(t){return t.ui=t.ui||{},t.ui.version="1.12.1"})?r.apply(e,i):r)||(t.exports=o)},function(t,e){var r;r=jQuery,mutate_event_stack=[{name:"width",handler:function(t){return n={el:t},r(n.el).data("mutate-width")||r(n.el).data("mutate-width",r(n.el).width()),!(!r(n.el).data("mutate-width")||r(n.el).width()==r(n.el).data("mutate-width")||(r(n.el).data("mutate-width",r(n.el).width()),0))}},{name:"height",handler:function(t){if(element=t,r(element).data("mutate-height")||r(element).data("mutate-height",r(element).height()),r(element).data("mutate-height")&&r(element).height()!=r(element).data("mutate-height"))return r(element).data("mutate-height",r(element).height()),!0}},{name:"top",handler:function(t){if(r(t).data("mutate-top")||r(t).data("mutate-top",r(t).css("top")),r(t).data("mutate-top")&&r(t).css("top")!=r(t).data("mutate-top"))return r(t).data("mutate-top",r(t).css("top")),!0}},{name:"bottom",handler:function(t){if(r(t).data("mutate-bottom")||r(t).data("mutate-bottom",r(t).css("bottom")),r(t).data("mutate-bottom")&&r(t).css("bottom")!=r(t).data("mutate-bottom"))return r(t).data("mutate-bottom",r(t).css("bottom")),!0}},{name:"right",handler:function(t){if(r(t).data("mutate-right")||r(t).data("mutate-right",r(t).css("right")),r(t).data("mutate-right")&&r(t).css("right")!=r(t).data("mutate-right"))return r(t).data("mutate-right",r(t).css("right")),!0}},{name:"left",handler:function(t){if(r(t).data("mutate-left")||r(t).data("mutate-left",r(t).css("left")),r(t).data("mutate-left")&&r(t).css("left")!=r(t).data("mutate-left"))return r(t).data("mutate-left",r(t).css("left")),!0}},{name:"hide",handler:function(t){if(r(t).is(":hidden"))return!0}},{name:"show",handler:function(t){if(r(t).is(":visible"))return!0}},{name:"scrollHeight",handler:function(t){if(r(t).data("prev-scrollHeight")||r(t).data("prev-scrollHeight",r(t)[0].scrollHeight),r(t).data("prev-scrollHeight")&&r(t)[0].scrollHeight!=r(t).data("prev-scrollHeight"))return r(t).data("prev-scrollHeight",r(t)[0].scrollHeight),!0}},{name:"scrollWidth",handler:function(t){if(r(t).data("prev-scrollWidth")||r(t).data("prev-scrollWidth",r(t)[0].scrollWidth),r(t).data("prev-scrollWidth")&&r(t)[0].scrollWidth!=r(t).data("prev-scrollWidth"))return r(t).data("prev-scrollWidth",r(t)[0].scrollWidth),!0}},{name:"scrollTop",handler:function(t){if(r(t).data("prev-scrollTop")||r(t).data("prev-scrollTop",r(t)[0].scrollTop()),r(t).data("prev-scrollTop")&&r(t)[0].scrollTop()!=r(t).data("prev-scrollTop"))return r(t).data("prev-scrollTop",r(t)[0].scrollTop()),!0}},{name:"scrollLeft",handler:function(t){if(r(t).data("prev-scrollLeft")||r(t).data("prev-scrollLeft",r(t)[0].scrollLeft()),r(t).data("prev-scrollLeft")&&r(t)[0].scrollLeft()!=r(t).data("prev-scrollLeft"))return r(t).data("prev-scrollLeft",r(t)[0].scrollLeft()),!0}}]},function(t,e){var n;n=jQuery,mutate={speed:1,event_stack:mutate_event_stack,stack:[],events:{},add_event:function(t){mutate.events[t.name]=t.handler},add:function(t,e,n,r){mutate.stack[mutate.stack.length]={event_name:t,selector:e,callback:n,false_callback:r}}},function t(){var e=mutate;"undefined"!=e.event_stack&&e.event_stack.length&&n.each(e.event_stack,(function(t,e){mutate.add_event(e)})),e.event_stack=[],n.each(e.stack,(function(t,r){n(r.selector).each((function(t,n){!0===e.events[r.event_name](n)?r.callback&&r.callback(n,r):r.false_callback&&r.false_callback(n,r)}))})),setTimeout(t,mutate.speed)}(),n.fn.extend({mutate:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=!1,e=arguments[1],r=this,i=arguments[2]?arguments[2]:function(){};return"extend"==arguments[0].toLowerCase()?(mutate.add_event(e),this):(n.each(n.trim(arguments[0]).split(" "),(function(n,o){t=o,mutate.add(t,r,e,i)})),this)}))})},function(t,e,n){var r=n(39),i=n(6)("socket.io-client:url");t.exports=function(t,e){var n=t;e=e||"undefined"!=typeof location&&location,null==t&&(t=e.protocol+"//"+e.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),i("parse %s",t),n=r(t));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(e&&e.port===n.port?"":":"+n.port),n}},function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,i=t.indexOf("["),o=t.indexOf("]");-1!=i&&-1!=o&&(t=t.substring(0,i)+t.substring(i,o).replace(/:/g,";")+t.substring(o,t.length));for(var s,a,u=n.exec(t||""),c={},l=14;l--;)c[r[l]]=u[l]||"";return-1!=i&&-1!=o&&(c.source=e,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=function(t,e){var n=e.replace(/\/{2,9}/g,"/").split("/");"/"!=e.substr(0,1)&&0!==e.length||n.splice(0,1);"/"==e.substr(e.length-1,1)&&n.splice(n.length-1,1);return n}(0,c.path),c.queryKey=(s=c.query,a={},s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(a[e]=n)})),a),c}},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=e.formatters[r];if("function"==typeof i){var o=s[u];n=i.call(t,o),s.splice(u,1),u--}return n})),e.formatArgs.call(t,s);var c=r.log||e.log||console.log.bind(console);c.apply(t,s)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(41),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){var n=1e3,r=6e4,i=60*r,o=24*i;function s(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var a,u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var s=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(t);if("number"===u&&!1===isNaN(t))return e.long?s(a=t,o,"day")||s(a,i,"hour")||s(a,r,"minute")||s(a,n,"second")||a+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){var r=n(12),i=n(20),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.deconstructPacket=function(t){var e=[],n=t.data,o=t;return o.data=function t(e,n){if(!e)return e;if(i(e)){var o={_placeholder:!0,num:n.length};return n.push(e),o}if(r(e)){for(var s=new Array(e.length),a=0;a<e.length;a++)s[a]=t(e[a],n);return s}if("object"==typeof e&&!(e instanceof Date)){s={};for(var u in e)s[u]=t(e[u],n);return s}return e}(n,e),o.attachments=e.length,{packet:o,buffers:e}},e.reconstructPacket=function(t,e){return t.data=function t(e,n){if(!e)return e;if(e&&e._placeholder)return n[e.num];if(r(e))for(var i=0;i<e.length;i++)e[i]=t(e[i],n);else if("object"==typeof e)for(var o in e)e[o]=t(e[o],n);return e}(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){var n=0,o=t;!function t(u,c,l){if(!u)return u;if(s&&u instanceof Blob||a&&u instanceof File){n++;var d=new FileReader;d.onload=function(){l?l[c]=this.result:o=this.result,--n||e(o)},d.readAsArrayBuffer(u)}else if(r(u))for(var h=0;h<u.length;h++)t(u[h],h,u);else if("object"==typeof u&&!i(u))for(var f in u)t(u[f],f,u)}(o),n||e(o)}},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=c(t),s=r[0],a=r[1],u=new o(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),l=0,d=a>0?s-4:s;for(n=0;n<d;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;2===a&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e);1===a&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(l(t,s,s+16383>a?a:s+16383));1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,s=[],a=e;a<n;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,d=n?i-1:0,h=n?-1:1,f=t[e+d];for(d+=h,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+t[e+d],d+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+d],d+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=c}return(f?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,d=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+d>=1?h/u:h*Math.pow(2,1-d))*u>=2&&(s++,u/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(e*u-1)*Math.pow(2,i),s+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+f]=255&s,f+=p,s/=256,c-=8);t[n+f-p]|=128*g}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=n(47),t.exports.parser=n(5)},function(t,e,n){var r=n(22),i=n(17),o=n(8)("engine.io-client:socket"),s=n(26),a=n(5),u=n(61),c=n(18);function l(t,e){if(!(this instanceof l))return new l(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=u(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=u(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.withCredentials=!1!==e.withCredentials,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=l,l.priorWebsocketSuccess=!1,i(l.prototype),l.protocol=a.protocol,l.Socket=l,l.Transport=n(16),l.transports=n(22),l.parser=n(5),l.prototype.createTransport=function(t){o('creating transport "%s"',t);var e=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.query);e.EIO=a.protocol,e.transport=t;var n=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new r[t]({query:e,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},l.prototype.open=function(){var t;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},l.prototype.setTransport=function(t){o("setting transport %s",t.name);var e=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},l.prototype.probe=function(t){o('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(o('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',t),r.upgrading=!0,r.emit("upgrading",e),!e)return;l.priorWebsocketSuccess="websocket"===e.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(o("changing transport and sending upgrade packet"),h(),r.setTransport(e),e.send([{type:"upgrade"}]),r.emit("upgrade",e),e=null,r.upgrading=!1,r.flush())}))}else{o('probe transport "%s" failed',t);var s=new Error("probe error");s.transport=e.name,r.emit("upgradeError",s)}})))}function s(){n||(n=!0,h(),e.close(),e=null)}function a(n){var i=new Error("probe error: "+n);i.transport=e.name,s(),o('probe transport "%s" failed because of error: %s',t,n),r.emit("upgradeError",i)}function u(){a("transport closed")}function c(){a("socket closed")}function d(t){e&&t.name!==e.name&&(o('"%s" works - aborting "%s"',t.name,e.name),s())}function h(){e.removeListener("open",i),e.removeListener("error",a),e.removeListener("close",u),r.removeListener("close",c),r.removeListener("upgrading",d)}l.priorWebsocketSuccess=!1,e.once("open",i),e.once("error",a),e.once("close",u),this.once("close",c),this.once("upgrading",d),e.open()},l.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},l.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else o('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},l.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},l.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},l.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},l.prototype.sendPacket=function(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:t,data:e,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},l.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():e()})):this.upgrading?r():e()}function e(){t.onClose("forced close"),o("socket closing - telling transport to close"),t.transport.close()}function n(){t.removeListener("upgrade",n),t.removeListener("upgradeError",n),e()}function r(){t.once("upgrade",n),t.once("upgradeError",n)}return this},l.prototype.onError=function(t){o("socket error %j",t),l.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},l.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},l.prototype.filterUpgrades=function(t){for(var e=[],n=0,r=t.length;n<r;n++)~s(this.transports,t[n])&&e.push(t[n]);return e}},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(t,e,n){var r=n(14),i=n(23),o=n(17),s=n(7),a=n(8)("engine.io-client:polling-xhr"),u=n(15);function c(){}function l(t){if(i.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,n=location.port;n||(n=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}}function d(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(t.exports=l,t.exports.Request=d,s(l,i),l.prototype.supportsBinary=!0,l.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.withCredentials=this.withCredentials,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new d(t)},l.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,r=this.request({method:"POST",data:t,isBinary:n}),i=this;r.on("success",e),r.on("error",(function(t){i.onError("xhr post error",t)})),this.sendXhr=r},l.prototype.doPoll=function(){a("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},o(d.prototype),d.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new r(t),n=this;try{a("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.withCredentials),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){n.onLoad()},e.onerror=function(){n.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof e.status?e.status:0)}),0))},a("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){n.onError(t)}),0)}"undefined"!=typeof document&&(this.index=d.requestsCount++,d.requests[this.index]=this)},d.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},d.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},d.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},d.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete d.requests[this.index],this.xhr=null}},d.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t=("application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},d.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},d.prototype.abort=function(){this.cleanup()},d.requestsCount=0,d.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",h);else if("function"==typeof addEventListener){addEventListener("onpagehide"in u?"pagehide":"unload",h,!1)}function h(){for(var t in d.requests)d.requests.hasOwnProperty(t)&&d.requests[t].abort()}},function(t,e){t.exports=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var r in t)n.call(t,r)&&e.push(r);return e}},function(t,e){t.exports=function(t,e,n){var r=t.byteLength;if(e=e||0,n=n||r,t.slice)return t.slice(e,n);if(e<0&&(e+=r),n<0&&(n+=r),n>r&&(n=r),e>=r||e>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(t),o=new Uint8Array(n-e),s=e,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer}},function(t,e){function n(){}t.exports=function(t,e,r){var i=!1;return r=r||n,o.count=t,0===t?e():o;function o(t,n){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(i=!0,e(t),e=r):0!==o.count||i||e(null,n)}}},function(t,e){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var n,r,i,o=String.fromCharCode;function s(t){for(var e,n,r=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function a(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function u(t,e){return o(t>>e&63|128)}function c(t,e){if(0==(4294967168&t))return o(t);var n="";return 0==(4294965248&t)?n=o(t>>6&31|192):0==(4294901760&t)?(a(t,e)||(t=65533),n=o(t>>12&15|224),n+=u(t,6)):0==(4292870144&t)&&(n=o(t>>18&7|240),n+=u(t,12),n+=u(t,6)),n+=o(63&t|128)}function l(){if(i>=r)throw Error("Invalid byte index");var t=255&n[i];if(i++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function d(t){var e,o;if(i>r)throw Error("Invalid byte index");if(i==r)return!1;if(e=255&n[i],i++,0==(128&e))return e;if(192==(224&e)){if((o=(31&e)<<6|l())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&e)){if((o=(15&e)<<12|l()<<6|l())>=2048)return a(o,t)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(o=(7&e)<<18|l()<<12|l()<<6|l())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(t,e){for(var n=!1!==(e=e||{}).strict,r=s(t),i=r.length,o=-1,a="";++o<i;)a+=c(r[o],n);return a},decode:function(t,e){var a=!1!==(e=e||{}).strict;n=s(t),r=n.length,i=0;for(var u,c=[];!1!==(u=d(a));)c.push(u);return function(t){for(var e,n=t.length,r=-1,i="";++r<n;)(e=t[r])>65535&&(i+=o((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=o(e);return i}(c)}}},function(t,e){!function(t){"use strict";e.encode=function(e){var n,r=new Uint8Array(e),i=r.length,o="";for(n=0;n<i;n+=3)o+=t[r[n]>>2],o+=t[(3&r[n])<<4|r[n+1]>>4],o+=t[(15&r[n+1])<<2|r[n+2]>>6],o+=t[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},e.decode=function(e){var n,r,i,o,s,a=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var l=new ArrayBuffer(a),d=new Uint8Array(l);for(n=0;n<u;n+=4)r=t.indexOf(e[n]),i=t.indexOf(e[n+1]),o=t.indexOf(e[n+2]),s=t.indexOf(e[n+3]),d[c++]=r<<2|i>>4,d[c++]=(15&i)<<4|o>>2,d[c++]=(3&o)<<6|63&s;return l}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},function(t,e){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function s(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var n=new Uint8Array(t.byteLength);n.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=n.buffer}return e}return t}))}function a(t,e){e=e||{};var r=new n;return s(t).forEach((function(t){r.append(t)})),e.type?r.getBlob(e.type):r.getBlob()}function u(t,e){return new Blob(s(t),e||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,u.prototype=Blob.prototype),t.exports=r?i?Blob:u:o?a:void 0},function(t,e,n){function r(t){var n;function r(){if(r.enabled){var t=r,i=+new Date,o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=e.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=e.formatters[r];if("function"==typeof i){var o=s[u];n=i.call(t,o),s.splice(u,1),u--}return n})),e.formatArgs.call(t,s);var c=r.log||e.log||console.log.bind(console);c.apply(t,s)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=function(t){var n,r=0;for(n in t)r=(r<<5)-r+t.charCodeAt(n),r|=0;return e.colors[Math.abs(r)%e.colors.length]}(t),r.destroy=i,"function"==typeof e.init&&e.init(r),e.instances.push(r),r}function i(){var t=e.instances.indexOf(this);return-1!==t&&(e.instances.splice(t,1),!0)}(e=t.exports=r.debug=r.default=r).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){var n;e.save(t),e.names=[],e.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")));for(n=0;n<e.instances.length;n++){var o=e.instances[n];o.enabled=e.enabled(o.namespace)}},e.enabled=function(t){if("*"===t[t.length-1])return!0;var n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(57),e.instances=[],e.names=[],e.skips=[],e.formatters={}},function(t,e){var n=1e3,r=6e4,i=60*r,o=24*i;function s(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}t.exports=function(t,e){e=e||{};var a,u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var s=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(t);if("number"===u&&!1===isNaN(t))return e.long?s(a=t,o,"day")||s(a,i,"hour")||s(a,r,"minute")||s(a,n,"second")||a+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=i)return Math.round(t/i)+"h";if(t>=r)return Math.round(t/r)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){var r=n(23),i=n(7),o=n(15);t.exports=l;var s,a=/\n/g,u=/\\n/g;function c(){}function l(t){r.call(this,t),this.query=this.query||{},s||(s=o.___eio=o.___eio||[]),this.index=s.length;var e=this;s.push((function(t){e.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){e.script&&(e.script.onerror=c)}),!1)}i(l,r),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},l.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},l.prototype.doWrite=function(t,e){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=s,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function c(){l(),e()}function l(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(t){n.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(t)}catch(t){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),l(),t=t.replace(u,"\\\n"),this.area.value=t.replace(a,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}},function(t,e,n){(function(e){var r,i,o=n(16),s=n(5),a=n(18),u=n(7),c=n(25),l=n(8)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{i=n(60)}catch(t){}var d=r||i;function h(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=r&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(d=i),o.call(this,t)}t.exports=h,u(h,o),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new d(t,e):new d(t):new d(t,e,n)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},h.prototype.write=function(t){var n=this;this.writable=!1;for(var r=t.length,i=0,o=r;i<o;i++)!function(t){s.encodePacket(t,n.supportsBinary,(function(i){if(!n.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),n.perMessageDeflate)("string"==typeof i?e.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(t){l("websocket closed before onclose event")}--r||a()}))}(t[i]);function a(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}},h.prototype.onClose=function(){o.prototype.onClose.call(this)},h.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},h.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=a.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t},h.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===h.prototype.name)}}).call(this,n(13).Buffer)},function(t,e){},function(t,e){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,i=t.indexOf("["),o=t.indexOf("]");-1!=i&&-1!=o&&(t=t.substring(0,i)+t.substring(i,o).replace(/:/g,";")+t.substring(o,t.length));for(var s,a,u=n.exec(t||""),c={},l=14;l--;)c[r[l]]=u[l]||"";return-1!=i&&-1!=o&&(c.source=e,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=function(t,e){var n=e.replace(/\/{2,9}/g,"/").split("/");"/"!=e.substr(0,1)&&0!==e.length||n.splice(0,1);"/"==e.substr(e.length-1,1)&&n.splice(n.length-1,1);return n}(0,c.path),c.queryKey=(s=c.query,a={},s.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,n){e&&(a[e]=n)})),a),c}},function(t,e){t.exports=function(t,e){for(var n=[],r=(e=e||0)||0;r<t.length;r++)n[r-e]=t[r];return n}},function(t,e){e.encode=function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},e.decode=function(t){for(var e={},n=t.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}},function(t,e){function n(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(t){this.ms=t},n.prototype.setMax=function(t){this.max=t},n.prototype.setJitter=function(t){this.jitter=t}},function(t,e){document.lang_values={"btn-publish":"Publish","btn-revert":"Revert","btn-revisions":"Revisions","btn-preview":"Preview","btn-toggle-boxes":"Toggle boxes","btn-add-container":"Add container","btn-add-box":"Add box","btn-cancle":"Cancel","btn-save":"Save","btn-make-reusable":"Make reusable","btn-wp-media":"Mediendatei einfügen","state-display":{published:"Published!",draft:"Is draft…"},"default-style":"Default style","rev-by-author":"by","placeholder-search-box":"Search boxes","title-tab-containers":"New container","title-tab-reuse-container":"Reusable container","title-wp-media":"Choose an image","label-title":"Title:","label-title-url":"Title URL (for internals links please use a relative path starting with '/'):","label-prolog":"Prolog:","label-epilog":"Epilog:","label-readmore":"Read more link label:","label-readmore-url":"Read more link URL (for internals links please use a relative path starting with '/'):","label-style":"Style:","label-b-before":"Prolog","label-b-dynamic":"Box specific settings","label-b-after":"Epilog",err_publish:"Could not publish…",err_revert:"Could not revert Grid…",err_container_reuse:"Error while trying to make container reusable!",err_container_save:"Could not save container.",err_container_delete:"Could not delete container.",err_slot_style:"Could not save slot style.",err_box_trash:"Could not delete box.",err_move_container:"Could not move containers. Site will reload!","err-move-box":"Error while moving box!","err-box-reuse":"Could not make box reusable. Please reload the page and try again.","err-box-save":"Could not save the box. Please reload the page and try again.",warn_container_edited:"Please finish container editing first.",warn_container_reuse_need_title:"The container needs a title to be reusable. Please try again.",warn_toggle_boxes_container_edited:"Please finish the container editing first.",prom_container_reuse_title:"Once a container is reusable you cannot modify it within this grid anymore. If you want to proceed choose a Reuse-Title and confirm:","confirm-box-reuse":"Once a box is reusable you cannot modify it within this grid anymore.\nProceed?","confirm-leave-page":"Do you really want to leave Grid?","confirm-grid-revert":"Delete all changes?","info-wp-hide-adminbar":"You can expand the admin menu here. Grid needs some more space, so the admin menu is automatically collapsed."}},function(t,e,n){"use strict";n.r(e);n(4),n(31),n(32),n(33),n(36),n(37);var r=n(0),i=n.n(r),o=n(2),s=n(3),a=n.n(s);
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridView=i.a.View.extend({tagName:"div",className:"grid-wrapper",initialize:function(){this._containersView=new ContainersView({collection:this.model.getContainers()})},render:function(){return this.$el.empty(),this.$el.append(a.a.tpl_grid(this.model.toJSON())),this.renderContainers(),this},renderContainers:function(){return this.$el.find(".containers-wrapper").replaceWith(this._containersView.render().el),this}}),window.ContainersView=i.a.View.extend({tagName:"div",className:"grid-containers-wrapper containers-wrapper",initialize:function(){this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"remove",this.render)},render:function(){var t=this;return this.$el.empty(),this.collection.each((function(e){var n=new ContainerView({model:e});t.$el.append(n.render().el)})),GRID._initializeBoxSortable(),this}}),window.ContainerView=i.a.View.extend({className:"grid-container",events:{"click [role=trash]":"selfdestruct","click [role=edit]":"onEdit","click [role=reuse]":"onReuse","click [role=toggleslotstyles]":"onToggleSlotStyles"},initialize:function(){var t=this;o.default.each(["title","titleurl","prolog","epilog","readmore","readmoreurl","style","style_label"],(function(e,n,r){t.listenTo(t.model,"change:"+e,t.render)})),this._slotsView=new SlotsView({collection:this.model.getSlots()})},render:function(){var t=this.model.toJSON();this.$el.attr("data-id",t.id).attr("data-type",t.type).attr("data-style",t.style).attr("data-reused",t.reused).attr("data-cid",this.model.cid).attr("data-space-left",this.model.getSpace("left")).attr("data-space-right",this.model.getSpace("right")),this.$el.addClass("grid-container-type-"+this.model.getType()),this.$el.addClass("grid-container-"+t.type),this.$el.addClass("grid-container-left-space-"+t.space_to_left),this.$el.addClass("grid-container-right-space-"+t.space_to_right);if(t.title&&(t.title_short=t.title.length<=60?t.title:t.title.substring(0,60)+"&hellip;"),t.prolog){var e=jQuery("<div>"+t.prolog+"</div>").text();t.prolog_short="<p>"+(e.length<=60?e:e.substring(0,60)+"&hellip;")+"</p>"}if(t.epilog){var n=jQuery("<div>"+t.epilog+"</div>").text();t.epilog_short="<p>"+(n.length<=60?n:n.substring(0,60)+"&hellip;")+"</p>"}return t.right_edit=GRID.getRights().get("edit-container"),t.right_delete=GRID.getRights().get("delete-container"),t.right_options=!0,t.right_delete||t.right_edit&&!t.reused||(t.right_options=!1),t.right_move=GRID.getRights().get("move-container"),t.isSidebar=t.type.startsWith("s"),this.$el.empty(),this.$el.append(a.a.tpl_container(t)),this.$slots_wrapper=this.$el.find(".grid-slots-wrapper"),this.$slots_wrapper.replaceWith(this._slotsView.render().el),this},onEdit:function(){var t=new GridContainerEditor({model:this.model});GRID.showEditor((function(){GRID.$root_editor.html(t.render().el)}))},saveEditor:function(){var t=this;return console.debug("ContainerView saveEditor",t),jQuery.each(this.$el.find(".form-val"),(function(e,n){var r=jQuery(n),i=r.attr("scope");t.model.set(i,r.val())})),this.model.save(),this.render()},onReuse:function(){var t=prompt("Bitte gib einen Titel für den Container ein");if(""==t||0==t||null==t)return!1;var e=this;return this.model.save(null,{reusetitle:t,action:"reuse",success:function(t){e.render()}}),this},onToggleSlotStyles:function(){this.$el.toggleClass("grid-container-show-slot-styles")},selfdestruct:function(){this.model.destroy({wait:!0}),this.remove()}}),window.SlotsView=i.a.View.extend({tagName:"div",className:"grid-slots-wrapper slots-wrapper",initialize:function(){this.collection.bind("add",this.render,this),this.collection.bind("remove",this.render,this)},render:function(){var t=this;return this.$el.empty(),this.collection.each((function(e){var n=new SlotView({model:e});n._parentView=t,t.$el.append(n.render().el)})),this}}),window.SlotView=i.a.View.extend({tagName:"div",className:"grid-slot",initialize:function(){this._boxesView=new BoxesView({collection:this.model.getBoxes()}),"box"!=GRID.mode&&(this._slotStyleChangerView=new GridSlotStyleChangerView({model:this.model})),this.listenTo(this.model,"change",this.render)},render:function(){var t=this.model.toJSON();return this.$el.attr("data-style",t.style).attr("data-id",t.id).attr("data-dimension",t.dimension),this.$el.addClass("grid-slot-"+t.dimension),this.$el.html(a.a.tpl_slot(this.model.toJSON())),"box"!=GRID.mode&&(this.$el.find(".style-changer").replaceWith(this._slotStyleChangerView.render().el),this._slotStyleChangerView.delegateEvents()),this._boxesView.render(),this.$el.find(".boxes-wrapper").replaceWith(this._boxesView.$el),this}}),window.BoxesView=i.a.View.extend({tagName:"div",className:"grid-boxes-wrapper boxes-wrapper",initialize:function(){this.collection.bind("add",this.render,this)},render:function(){var t=this;return this.$el.empty(),this.collection.each((function(e){var n=new BoxView({model:e});n._parentView=t,t.$el.append(n.render().el)})),this}}),window.BoxView=i.a.View.extend({className:"grid-box box",events:{"click .grid-box-edit":"edit","click .grid-box-delete":"deleteBox","click .grid-box-duplicate":"duplicateBox"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.selfdestruct)},render:function(){var t=this.model.toJSON();this.$el.attr("data-id",t.id).attr("data-type",t.type).attr("data-style",t.style),this.$el.addClass("grid-box-"+t.type),"reference"==t.type&&(t.reference=!0),t.right_move=GRID.getRights().get("move-box"),t.right_edit=GRID.getRights().get("edit-box"),t.right_create=GRID.getRights().get("create-box"),t.right_delete=GRID.getRights().get("delete-box"),t.right_none=!1,t.right_move||t.right_edit||t.right_delete||(t.right_none=!0),GRID.log(["render box",t]);for(var e=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;e.test(t.html);)t.html=t.html.replace(e,"");for(;e.test(t.epilog);)t.epilog=t.epilog.replace(e,"");for(;e.test(t.prolog);)t.prolog=t.prolog.replace(e,"");return this.model.isDuplicated()&&(this.model.unsetDuplicated(),this.$el.addClass("is-duplicated")),this.$el.html(a.a.tpl_box(t)),this},edit:function(){var t=new BoxEditor({model:this.model});GRID.showEditor((function(){GRID.$root_editor.html(t.render().el)}))},deleteBox:function(){this.model.destroy()},duplicateBox:function(){this.model.duplicate()},selfdestruct:function(){this.remove()}}),window.BoxEditor=i.a.View.extend({events:{"click .btn-cancel":"onCancel","click .grid-editor-legend":"onToggle","click .btn-save":"onSave","click .btn-make-reusable":"onMakeReusable"},initialize:function(){},render:function(){GRID.log(this.model.toJSON());var t=GRID.getBoxStyles().toJSON(),e=this;o.default.each(t,(function(t){t.slug==e.model.get("style")?t.selected="selected":t.selected=""})),this.$el.html(a.a.tpl_boxeditor({lang_values:document.lang_values,box:this.model.toJSON(),b_index:this.model.getIndex(),c_id:this.model.getContainer().get("id"),s_id:this.model.getSlot().get("id"),styles:t}));var n=this.model.get("contentstructure"),r=jQuery(this.$el).find(".dynamic-fields .field-wrapper"),i=[];e=this;return o.default.each(n,(function(t){var n=t.type,o=new boxEditorControls[n]({model:{structure:t,container:e.model.get("content"),box:e.model,parentpath:""}});i.push(o),r.append(o.render().el)})),this.views=i,jQuery.each(jQuery(this.$el).find(".form-html"),(function(t,e){CKEDITOR.replace(e,{customConfig:document.PathToConfig})})),GRID.getBoxStyles().length<1&&jQuery(this.$el).find(".box-styles-wrapper").hide(),this},onCancel:function(){GRID.hideBoxEditor((function(){jQuery("div#new-grid-boxeditor").html("")}))},onToggle:function(t){jQuery(t.target).siblings(".field-wrapper").slideToggle(300)},onMakeReusable:function(t){confirm(document.lang_values["confirm-box-reuse"])&&(this.model.save(null,{action:"reuse"}),GRID.hideBoxEditor((function(){jQuery("div#new-grid-boxeditor").html("")})))},onSave:function(t){var e={};o.default.each(this.views,(function(t){e[t.model.structure.key]=t.fetchValue()})),this.model.set("content",e),this.model.set("title",jQuery(this.$el).find(".f-b-title").val()),this.model.set("titleurl",jQuery(this.$el).find(".f-b-titleurl").val()),this.model.set("prolog",CKEDITOR.instances["f-b-prolog"].getData()),this.model.set("epilog",CKEDITOR.instances["f-b-epilog"].getData()),this.model.set("readmore",jQuery(this.$el).find(".f-b-readmore").val()),this.model.set("readmoreurl",jQuery(this.$el).find(".f-b-readmoreurl").val()),this.model.set("style",jQuery(this.$el).find(".box-styles-wrapper select").val()),this.model.save(),GRID.hideBoxEditor((function(){jQuery("div#new-grid-boxeditor").html("")}))}}),window.boxEditorControls={};var u=function(t){return jQuery(t).data("ckeditor")},c=function(t){return new Promise((function(e,n){!function(t){return u(t)}(t)?e(CKEDITOR.replace(t,{customConfig:document.PathToConfig})):e(u(t))}))};function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridContainerEditor=i.a.View.extend({className:"grid-container-editor",events:{"click .grid-editor-controls [role=cancel]":"onCancel","click .grid-editor-controls [role=save]":"onSave","click .grid-editor-legend":"onToggle","click .grid-editor-url-button":"onUrlToggle"},initialize:function(){},render:function(){var t=this;GRID.log(this.model.toJSON());var e=GRID.getContainerStyles().toJSON(),n=this;return o.default.each(e,(function(t){t.slug==n.model.get("style")?t.selected="selected":t.selected=""})),this.$el.html(a.a.tpl_containereditor({lang_values:document.lang_values,model:this.model.toJSON(),styles:e})),c(this.el.querySelector(".grid-editor-prolog")).then((function(e){return t.prologEditor=e})),c(this.el.querySelector(".grid-editor-epilog")).then((function(e){return t.epilogEditor=e})),this.$el.find(".grid-collapsable-shown").addClass("grid-active"),jQuery.each(this.$el.find(".grid-editor-url-input"),(function(t,e){var n=jQuery(e);""==n.val()&&n.siblings("button").trigger("click")})),this},onToggle:function(t){jQuery(t.currentTarget).parent().toggleClass("grid-active")},onUrlToggle:function(t){var e=jQuery(t.target).parent();e.hasClass("grid-editor-url-show")?(e.find("input").attr("disabled","disabled").val(""),e.find("button").html("Add link")):(e.find("button").html("Delete Link"),e.find("input").removeAttr("disabled")),jQuery(t.target).parent().toggleClass("grid-editor-url-show")},onCancel:function(){GRID.hideEditor((function(){jQuery(GRID.$root_editor).html("")}))},onSave:function(t){this.model.set("title",this.$el.find(".grid-editor-title").val()),this.model.set("titleurl",this.$el.find(".grid-editor-titleurl").val()),this.model.set("prolog",this.prologEditor.getData()),this.model.set("epilog",this.epilogEditor.getData()),this.model.set("readmore",this.$el.find(".grid-editor-readmore").val()),this.model.set("readmoreurl",this.$el.find(".grid-editor-readmoreurl").val()),this.model.set("style",this.$el.find(".grid-editor-style").val()),this.model.set("style_label",jQuery(this.$el).find(".grid-editor-style option:selected").text()),this.model.save(),GRID.hideEditor((function(){GRID.$root_editor.html("")}))}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.BoxEditor=i.a.View.extend({className:"grid-box-editor",events:{"click .grid-editor-controls [role=cancel]":"onCancel","click .grid-editor-legend":"onToggle","click .grid-editor-controls [role=save]":"onSave","click .grid-editor-controls [role=reuse]":"onMakeReusable","click .grid-editor-url-button":"onUrlToggle"},initialize:function(){},render:function(){var t=this,e=GRID.getBoxStyles().toJSON(),n=this;o.default.each(e,(function(t){t.slug===n.model.get("style")?t.selected="selected":t.selected=""})),this.$el.html(a.a.tpl_boxeditor({lang_values:document.lang_values,box:this.model.toJSON(),b_index:this.model.getIndex(),c_id:this.model.getContainer().get("id"),s_id:this.model.getSlot().get("id"),styles:e}));var r=this.model.get("contentstructure"),i=this.$el.find(".grid-dynamic-fields .grid-editor-field-wrapper"),s=[];return o.default.each(r,(function(t){var e=t.type,r=new boxEditorControls[e]({model:{structure:t,container:n.model.get("content"),box:n.model,parentpath:""}});s.push(r),i.append(r.render().el)})),this.views=s,c(this.el.querySelector(".grid-editor-prolog")).then((function(e){return t.prologEditor=e})),c(this.el.querySelector(".grid-editor-epilog")).then((function(e){return t.epilogEditor=e})),GRID.getBoxStyles().length<1&&this.$el.find(".grid-editor-box-styles-wrapper").hide(),this.$el.find(".grid-collapsable-shown").addClass("grid-active"),jQuery.each(this.$el.find(".grid-editor-url-input"),(function(t,e){var n=jQuery(e);""==n.val()&&n.siblings("button").trigger("click")})),this},onCancel:function(){GRID.hideEditor((function(){GRID.$root_editor.html("")}))},onToggle:function(t){jQuery(t.currentTarget).parent().toggleClass("grid-active")},onUrlToggle:function(t){var e=jQuery(t.target).parent();e.hasClass("grid-editor-url-show")?(e.find("input").attr("disabled","disabled").val(""),e.find("button").html("Add link")):(e.find("button").html("Delete Link"),e.find("input").removeAttr("disabled")),jQuery(t.target).parent().toggleClass("grid-editor-url-show")},onMakeReusable:function(t){confirm(document.lang_values["confirm-box-reuse"])&&(this.model.save(null,{action:"reuse"}),GRID.hideEditor((function(){GRID.$root_editor.html("")})))},onSave:function(t){var e={};o.default.each(this.views,(function(t){e[t.model.structure.key]=t.fetchValue()})),this.model.set("content",e),this.model.set("title",this.$el.find(".grid-editor-title").val()),this.model.set("titleurl",this.$el.find(".grid-editor-titleurl").val()),this.model.set("prolog",this.prologEditor.getData()),this.model.set("epilog",this.epilogEditor.getData()),this.model.set("readmore",this.$el.find(".grid-editor-readmore").val()),this.model.set("readmoreurl",this.$el.find(".grid-editor-readmoreurl").val()),this.model.set("style",this.$el.find(".grid-editor-styles-wrapper select").val()),this.model.save(),GRID.hideEditor((function(){GRID.$root_editor.html("")}))}}),boxEditorControls={},boxEditorControls.autocomplete=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-autocomplete",events:{"keyup .i-autocomplete":"keyup","click .suggestion-list li":"listItemSelected","click .cancel":"cancelSelection"},initialize:function(){},render:function(){var t="<label>"+this.model.structure.label+"</label>",e="autocomplete-wrapper form-autocomplete dynamic-value",n="",r=!1,i=this.model.container[this.model.structure.key];if("undefined"!==l(i)&&""!==i&&(e+=" locked",n="readonly=readonly",r=!0),t+="<div class='"+e+"'><input type=text class='form-text autocomplete i-autocomplete' "+n+"/>",t+="<div class='loading'></div>",t+="<div class='cancel icon-cancel'></div>",t+="<ul class='suggestion-list'></ul>",this.$el.html(t),r){this.$el.find(".loading").addClass("go"),this.$el.find("input.i-autocomplete").data("key",i);var o=this.model.box,s=this;new GridAjax("typeAheadGetText",[o.getGrid().getGridID(),o.getContainer().get("id"),o.getSlot().get("id"),o.getIndex(),this.model.parentpath+this.model.structure.key,i],{success_fn:function(t){s.$el.find(".loading").removeClass("go"),s.$el.find("input.i-autocomplete").val(t.result)}})}return this},fetchValue:function(){return this.$el.find("input.i-autocomplete").data("key")},keyup:function(t){if(13==t.which)this.selectItem(this.$el.find(".suggestion-list li").first());else{var e=this.$el.find("input.i-autocomplete").val();this.$el.find(".loading").addClass("go"),clearTimeout(this.searching);var n=this;this.searching=setTimeout((function(){n.doSearch(e)}),1e3)}},doSearch:function(t){var e=this,n=this.model.box;new GridAjax("typeAheadSearch",[n.getGrid().getGridID(),n.getContainer().get("id"),n.getSlot().get("id"),n.getIndex(),this.model.parentpath+this.model.structure.key,t],{success_fn:function(t){e.$el.find(".suggestion-list").empty(),o.default.each(t.result,(function(t){e.$el.find(".suggestion-list").append(jQuery("<li/>").text(t.value).attr("data-key",t.key))})),e.$el.find(".loading").removeClass("go")}})},selectItem:function(t){var e=t.data("key"),n=t.text();this.$el.find(".autocomplete-wrapper").addClass("locked"),this.$el.find("input.i-autocomplete").val(n).attr("readonly","readonly").data("key",e),this.$el.find(".suggestion-list").empty()},listItemSelected:function(t){this.selectItem(jQuery(t.target))},cancelSelection:function(t){this.$el.find(".autocomplete-wrapper").removeClass("locked"),this.$el.find("input.i-autocomplete").data("key","").removeAttr("readonly").val(""),this.old_search_string=""}}),boxEditorControls["autocomplete-with-links"]=i.a.View.extend({className:"grid-editor-widget grid-editor-autocomplete-with-links",events:{"keyup .i-autocomplete":"keyup","click .suggestion-list li":"listItemSelected","click .cancel":"cancelSelection"},initialize:function(){},render:function(){var t="<label>"+this.model.structure.label+"</label>",e="autocomplete-wrapper form-autocomplete dynamic-value",n="",r=!1,i=this.model.container[this.model.structure.key];if("undefined"!==d(i)&&""!==i&&(e+=" locked",n="readonly",r=!0),t+="<div class='"+e+"'>",t+="<input type=text class='form-text autocomplete i-autocomplete' "+n+"/>",t+="<div class='cancel'><span class='icon-cancel'></span></div>",t+="<ul class='suggestion-list'></ul>",t+='<p class="links">',t+='<a class="empty" data-raw="'+this.model.structure.emptyurl+'" href="'+this.model.structure.emptyurl+'" target="_blank">'+this.model.structure.emptylinktext+"</a>",t+='<a class="full" data-raw="'+this.model.structure.url+'" href="" target="_blank">'+this.model.structure.linktext+"</a>",t+="</p>",t+="</div>",jQuery(this.$el).html(t),r){this.$el.find("input.i-autocomplete").data("key",i);var o=this.model.box,s=this;new GridAjax("typeAheadGetText",[o.getGrid().getGridID(),o.getContainer().get("id"),o.getSlot().get("id"),o.getIndex(),this.model.parentpath+this.model.structure.key,i],{success_fn:function(t){s.$el.find("input.i-autocomplete").val(t.result)}});var a=this.$el.find("a.full");a.attr("href",a.data("raw").replace("%",i))}return this},fetchValue:function(){return this.$el.find("input.i-autocomplete").data("key")},keyup:function(t){var e=this.$el.find("input.i-autocomplete");if(void 0===e.attr("readonly")&&!1!==e.attr("readonly"))if(13===t.which)this.selectItem(this.$el.find(".suggestion-list li").first());else{var n=this.$el.find("input.i-autocomplete").val();if(n==this.old_search_string)return;var r=this;this.$el.find(".loading").show(),clearTimeout(this.searching),this.searching=setTimeout((function(){r.doSearch(n)}),1e3)}},doSearch:function(t){var e=this,n=this.model.box;new GridAjax("typeAheadSearch",[n.getGrid().getGridID(),n.getContainer().get("id"),n.getSlot().get("id"),n.getIndex(),this.model.parentpath+this.model.structure.key,t],{success_fn:function(n){e.old_search_string=t,e.$el.find(".suggestion-list").empty(),o.default.each(n.result,(function(t){e.$el.find(".suggestion-list").append(jQuery("<li/>").text(t.value).attr("data-key",t.key))})),e.$el.find(".loading").hide()}})},selectItem:function(t){var e=t.data("key"),n=t.text();this.$el.find(".autocomplete-wrapper").addClass("locked"),this.$el.find("input.i-autocomplete").val(n).attr("readonly","readonly").data("key",e),this.$el.find(".suggestion-list").empty();var r=this.$el.find("a.full");r.attr("href",r.data("raw").replace("%",e))},listItemSelected:function(t){this.selectItem(jQuery(t.target))},cancelSelection:function(t){this.$el.find(".autocomplete-wrapper").removeClass("locked"),this.$el.find("input.i-autocomplete").data("key","").removeAttr("readonly").val(""),this.old_search_string=""}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.checkbox=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-checkbox",render:function(){var t="<label><input type='checkbox' "+(this.model.container[this.model.structure.key]?"checked=checked":"")+" /> "+this.model.structure.label+"</label>";return this.$el.html(t),this},fetchValue:function(){return this.$el.find("input[type=checkbox]").is(":checked")}}),boxEditorControls.file=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-file",initialize:function(){},render:function(){jQuery,this.model.container[this.model.structure.key];var t=jQuery("<div class='form-item file-upload'>");t.append("<label>"+this.model.structure.label+"</label>"),this.$preview=jQuery("<div></div>").addClass("file-upload-preview"),t.append(this.$preview);var e=jQuery("<input type='file' data-path='"+this.model.parentpath+this.model.structure.key+"' class='form-file' />");t.append(e);var n=this.model.container[this.model.structure.key];this.$key_field=jQuery("<input type='hidden' data-key='"+this.model.structure.key+"' value='"+("undefined"!==h(n)?n:"")+"' class='dynamic-value' />"),t.append(this.$key_field),this.$progress_display=jQuery("<p>").addClass("progress"),this.$progress_bar_wrapper=jQuery("<div class='progress-bar-wrapper'><div class='bar'></div>"),this.$progress_bar_status=this.$progress_bar_wrapper.children(".bar"),""===this.model.container[this.model.structure.key]||void 0===this.model.container[this.model.structure.key]?this.$progress_display.text(this.getFileChooseHelp()):(this.$progress_display.text(this.getFileReplaceHelp()),this.$progress_bar_status.addClass("done")),t.append(this.$progress_display).append(this.$progress_bar_wrapper);var r=this;return e.fileupload({url:this.model.structure.uploadpath,dataType:"json",paramName:"file",done:function(t,e){r.uploadDone(t,e),r.loadPreview()},progressall:function(t,e){r.progressall(t,e)},always:function(t,e){GRID.log(t,e)}}).bind("fileuploadsubmit",{self:r},this.getFormData),this.$el.append(t),this.loadPreview(),this},loadPreview:function(){this.$preview.empty();var t=this.$key_field.val(),e=this.model.parentpath+this.model.structure.key;if("undefined"!==h(t)&&""!==t){var n=this,r=this.model.box,i=[r.getGrid().getGridID(),r.getContainer().get("id"),r.getSlot().get("id"),r.getIndex(),e,t];new GridAjax("getFileInfo",i,{success_fn:function(t){n.$preview.append(jQuery("<img>").css("max-width","200px").attr("src",t.result.src))}})}},getFormData:function(t,e){var n=t.data.self,r=n.model.parentpath+n.model.structure.key,i=n.model.box;e.formData={gridid:GRID.ID,container:i.getContainer().get("id"),slot:i.getSlot().get("id"),box:i.getIndex(),key:r},n.$progress_bar_status.removeClass("done")},progressall:function(t,e){var n=e.loaded/e.total*100;this.$progress_display.text(Math.round(n)+"%"),this.$progress_bar_status.css("width",n+"%")},uploadDone:function(t,e){var n=e.result;this.$key_field.val(n.result),this.$progress_display.text("OK!"),this.$progress_bar_status.addClass("done")},fetchValue:function(){return this.$key_field.val()},getFileReplaceHelp:function(){return void 0!==this.model.structure.fileReplacementHelp?this.model.structure.fileReplacementHelp:"Choose another picture to override the old one."},getFileChooseHelp:function(){return void 0!==this.model.structure.fileChooseHelp?this.model.structure.fileChooseHelp:"Please choose a picture..."}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.hidden=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-hidden",initialize:function(){},render:function(){return this},fetchValue:function(){return this.model.container[this.model.structure.key]}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.html=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-html",render:function(){var t=this,e=this.model.container[this.model.structure.key]||"";return this.$el.html("<label>"+this.model.structure.label+"</label><textarea name='"+this.cid+"' class='dynamic-value form-html'>"+e.replace(/\'/g,"&#39;")+"</textarea>"),c(this.el.querySelector(".form-html")).then((function(e){t.editor=e})),this},fetchValue:function(){return this.editor.getData()}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.info=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-info",initialize:function(){},render:function(){return null!=this.model.structure.label?jQuery(this.el).html("<label>"+this.model.structure.label+"</label><p class='info'>"+this.model.structure.text+"</p>"):jQuery(this.el).html("<p class='info'>"+this.model.structure.text+"</p>"),this},fetchValue:function(){return{}}}),boxEditorControls.input=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-input",initialize:function(){},render:function(){this.$el.empty();var t=this.model.container[this.model.structure.key];return this.$el.append(jQuery("<label />").text(this.model.structure.label)),this.$el.append(jQuery("<input />").addClass("dynamic-value").attr("type",this.model.structure.inputType).val("undefined"===f(t)?"":t)),this.$el.addClass("grid-editor-widget-input__"+this.model.structure.inputType),this},fetchValue:function(){return jQuery(this.$el).find("input").val()}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.list=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-list",initialize:function(){},render:function(){this.$el.empty(),jQuery("<label></label>").text(this.model.structure.label).appendTo(this.$el),this.$list=jQuery("<div></div>").addClass("grid-editor-widget-list-items"),this.$el.append(this.$list);var t=this.model.container[this.model.structure.key],e=this,n=[];return jQuery("<button><span class='icon-plus'></span>Add item</button>").addClass("grid-editor-widget-list-add").appendTo(this.$el).on("click",(function(t){t.preventDefault(),e.onAdd()})),o.default.each(t,(function(t){var r=new boxEditorControls.listitem({model:{structure:e.model.structure.contentstructure,container:t,box:e.model.box,parentpath:e.model.parentpath+e.model.structure.key+"."}});n.push(r),e.$list.append(r.render().$el)})),this.views=n,this.$list.on("click",".widget-list-sort-button",{self:this},this.sortItem),this.$list.on("click",".widget-list-remove-item-button",{self:this},this.onRemove),this},sortItem:function(t){var e=t.data.self,n=jQuery(t.currentTarget),r=n.closest(".grid-editor-widget-listitem"),i=r.index(),o=e.views,s=o[i],a=i;switch(n.attr("data-dir")){case"up":(a=i-1)<0&&(a=0),r.insertBefore(r.prev());break;case"down":a=i+1,r.insertAfter(r.next())}o.splice(i,1),o.splice(a,0,s)},onRemove:function(t){var e=t.data.self,n=jQuery(t.currentTarget).closest(".grid-editor-widget-listitem").index();e.model.container[e.model.structure.key].splice(n,1),e.views[n].removed=!0,e.views[n].remove(),e.views.splice(n,1),console.log(["remove",t,e])},onAdd:function(){var t=new boxEditorControls.listitem({model:{structure:this.model.structure.contentstructure,container:{},box:this.model.box,parentpath:this.model.parentpath+this.model.structure.key+"."}});this.views.push(t),this.$list.append(t.render().el)},fetchValue:function(){var t=[];return o.default.each(this.views,(function(e){e.removed||t.push(e.fetchValue())})),t}}),boxEditorControls.listitem=i.a.View.extend({className:"grid-editor-widget-listitem",removed:!1,initialize:function(){},render:function(){var t=[],e=this;return o.default.each(this.model.structure,(function(n){var r=n.type,i=new boxEditorControls[r]({model:{structure:n,container:e.model.container,box:e.model.box,parentpath:e.model.parentpath}});t.push(i),e.$el.append(i.render().el)})),jQuery("<button class='widget-list-remove-item-button'><span class='icon-minus'></span>Remove item</button>").appendTo(this.$el),jQuery("<button class='widget-list-move-up-item-button widget-list-sort-button' data-dir='up'><span class='icon-dir-up'></span></button>").appendTo(this.$el),jQuery("<button class='widget-list-move-down-item-button widget-list-sort-button' data-dir='down'><span class='icon-dir-down'></span></button>").appendTo(this.$el),this.views=t,this},fetchValue:function(){var t={};return o.default.each(this.views,(function(e){t[e.model.structure.key]=e.fetchValue()})),t}}),boxEditorControls["multi-autocomplete"]=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-multi-autocomplete",events:{"keyup .i-autocomplete":"keyup","click .suggestion-list li":"listItemSelected"},initialize:function(){},render:function(){var t="<label>"+this.model.structure.label+"</label>",e=!1;if(""==this.model.container[this.model.structure.key]&&0!==this.model.container[this.model.structure.key]||(e=!0),t+="<div class='autocomplete-wrapper form-autocomplete dynamic-value'><input type=text class='form-text autocomplete i-autocomplete' />",t+="<div class='loading'></div>",t+="<ul class='suggestion-list'></ul>",this.$el.html(t),this.$el.on("click",".icon-cancel",(function(t){var e=jQuery(this).parent();e.empty(),e.remove()})),e){var n=this,r=this.model.box,i=this.model.container[this.model.structure.key];"undefined"===p(i)?i=[]:p(i)!==p([])&&(i=[i]),jQuery.each(i,(function(t,e){n.$el.find(".loading").addClass("go"),new GridAjax("typeAheadGetText",[r.getGrid().getGridID(),r.getContainer().get("id"),r.getSlot().get("id"),r.getIndex(),n.model.parentpath+n.model.structure.key,e],{success_fn:function(t){n.$el.find(".loading").removeClass("go"),n.$el.find(".autocomplete-wrapper").append("<div class='autocomplete-multiselect-item' data-key='"+e+"'><span>"+t.result+"</span><span class='icon icon-cancel'></span></div>")}})}))}return this},fetchValue:function(){var t=[];return this.$el.find(".autocomplete-multiselect-item").each((function(e,n){t.push(jQuery(n).data("key"))})),t},keyup:function(t){if(13==t.which)this.selectItem(this.$el.find(".suggestion-list li").first());else{var e=this,n=this.$el.find("input.i-autocomplete").val();if(this.$el.find("input.i-autocomplete").val()==this.old_search_string)return;e.old_search_string=n,this.$el.find(".loading").addClass("go"),clearTimeout(this.searching),this.searching=setTimeout((function(){e.doSearch(n)}),1e3)}},doSearch:function(t){var e=this,n=this.model.box;new GridAjax("typeAheadSearch",[n.getGrid().getGridID(),n.getContainer().get("id"),n.getSlot().get("id"),n.getIndex(),this.model.parentpath+this.model.structure.key,t],{success_fn:function(t){e.$el.find(".suggestion-list").empty(),o.default.each(t.result,(function(t){e.$el.find(".suggestion-list").append(jQuery("<li/>").text(t.value).attr("data-key",t.key))})),e.$el.find(".loading").removeClass("go")}})},selectItem:function(t){var e=t.data("key"),n=t.text();jQuery(".autocomplete-multiselect-item[data-key='"+e+"']").length?(this.$el.find(".suggestion-list").empty(),this.$el.find("input.i-autocomplete").removeAttr("value")):this.$el.find(".autocomplete-wrapper").append(jQuery("<div></div>").addClass("autocomplete-multiselect-item").text(n).attr({"data-key":e}).append(jQuery("<span></span>").addClass("icon icon-cancel").click((function(){var t=jQuery(this).parent();t.empty(),t.remove()})))),this.$el.find(".suggestion-list").empty(),this.$el.find("input.i-autocomplete").val("")},listItemSelected:function(t){this.selectItem(jQuery(t.target))}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.number=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-number",initialize:function(){},render:function(){var t=this.model.container[this.model.structure.key];return t||(t=""),this.$el.html("<label>"+this.model.structure.label+"</label><input type=number class='dynamic-value' value='"+t+"'/>"),this},fetchValue:function(){return jQuery(this.$el).find("input").val()}}),boxEditorControls.select=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-select",initialize:function(){},render:function(){var t=this.model.structure,e=this.model.container;console.debug(t,e);var n="undefined"!==g(t.multiple)&&t.multiple,r=e[t.key],i=g(r)===g([]),s=t.selections,a=n?"multiple='multiple'":"",u=!n||s.size<8?"":s.length<12?"size='6'":"size='8'",c="<label>"+this.model.structure.label+"</label><select "+a+" "+u+">";return o.default.each(s,(function(t){var e="";(!i&&"".concat(r)==="".concat(t.key)||i&&o.default.indexOf(r,t.key)>-1)&&(e="selected"),c+="<option "+e+" value='"+t.key+"'>"+t.text+"</option>"})),c+="</select>",jQuery(this.el).html(c),this},fetchValue:function(){return jQuery(this.$el).find("select").val()}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.text=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-text",initialize:function(){},render:function(){return this.$el.empty(),this.$el.append(jQuery("<label/>").text(this.model.structure.label)),this.$el.append(jQuery("<input type=text class='dynamic-value'/>").val(this.model.container[this.model.structure.key]||"")),this},fetchValue:function(){return jQuery(this.$el).find("input").val()}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
boxEditorControls.textarea=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-textarea",initialize:function(){},render:function(){var t=this.model.container[this.model.structure.key];return t||(t=""),this.$el.html("<label>"+this.model.structure.label+"</label><textarea class='dynamic-value form-textarea'>"+t+"</textarea>"),this},fetchValue:function(){return jQuery(this.$el).find("textarea").val()}}),boxEditorControls["wp-mediaselect"]=i.a.View.extend({className:"grid-editor-widget grid-editor-widget-wp-mediaselect",events:{"click .upload_image_button":"open_wp_media"},initialize:function(){},render:function(){var t=this.model.structure,e=this.model.container[t.key];return this.$el.append("<label>"+t.label+"</label>"),this.media_type="*","undefined"!=m(t.media_type)&&(this.media_type=t.media_type),this.$img_wrapper=jQuery("<div></div>"),this.$img_wrapper.addClass("wp-mediaselect-image-wrapper"),this.$el.append(this.$img_wrapper),this.$upload_btn=jQuery("<button class='button upload_image_button'>Media</button>"),this.$el.append(this.$upload_btn),this.$input=jQuery("<input />").attr("value",JSON.stringify(e)).attr("type","hidden").addClass("dynamic-value form-json").attr("data-path",this.model.parentpath+t.key).attr("data-key",t.key),this.$el.append(this.$input),this.$select_image_size=jQuery("<select class='image-sizes'></select>"),this.$el.append(this.$select_image_size),this.$select_image_size.on("change",(function(){var t=jQuery(this),e=JSON.parse(t.siblings(".dynamic-value").val());e.size=t.val(),t.siblings(".dynamic-value").val(JSON.stringify(e))})),this.buildImageSizeSelect(),this.buildImagePreview(),this},open_wp_media:function(){var t=this,e=wp.media({multiple:!1,library:{type:this.media_type},button:{text:"Insert"}});return e.on("open",(function(){var n=e.state().get("selection"),r=JSON.parse(t.$input.val()),i=wp.media.attachment(r.id);n.add(i?[i]:[])})),e.on("close",(function(){e.state().get("selection");jQuery.each(e.state().get("selection")._byId,(function(e,n){var r=n.get("sizes");void 0===r&&(r={full:{height:"",width:"",url:n.get("url"),orientation:""}});var i={id:n.id,size:"full",sizes:r};return t.$input.val(JSON.stringify(i)),t.buildImageSizeSelect(),t.buildImagePreview(),!1}))})),e.open(),!1},get_json_from_input:function(){var t=null;if("object"!=this.$input.val())try{t=JSON.parse(this.$input.val())}catch(e){t=null}else t=this.$input.val();return t},buildImagePreview:function(){var t=this.get_json_from_input();if(null!=t&&""!=t&&m(t)==m({})&&m(t.sizes)==m({})&&m(t.sizes.thumbnail)==m({})&&m(t.sizes.thumbnail.url)==m("")){var e=jQuery("<img/>");e.addClass("wp-mediaselect-image-preview").attr("src",t.sizes.thumbnail.url).attr("width",t.sizes.thumbnail.width).attr("height",t.sizes.thumbnail.height),this.$img_wrapper.empty(),this.$img_wrapper.append(e)}},buildImageSizeSelect:function(){var t=this;if(""!=this.$input.val()){var e=this.get_json_from_input();null!=e&&""!=e&&m(e)==m({})&&m(e.sizes)==m({})?(this.$select_image_size.empty(),jQuery.each(e.sizes,(function(n,r){var i="";e.size==n&&(i="selected='selected'"),jQuery("<option "+i+" >"+n+"</option>").attr("value",n).appendTo(t.$select_image_size)})),this.$select_image_size.children().length>0?this.$select_image_size.show():this.$select_image_size.hide()):this.$select_image_size.hide()}},fetchValue:function(){var t="";try{t=JSON.parse(this.$input.val())}catch(t){GRID.log("empty image box")}return t}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridRevisionsView=i.a.View.extend({tagName:"div",className:"grid-revisions",events:{"click [role=preview]":"onPreview","click [role=delete]":"onDelete","click [role=revert]":"onRevert"},initialize:function(){this.listenTo(this.collection,"add",this.render),this.$list=jQuery("<div class='grid-revisions-list'></ul>"),this.$el.append(this.$list),this.interval=setInterval(this.onRevisionsScroll.bind(this),1e3)},render:function(){var t=this.collection.toJSON();o.default.each(t,(function(t){if(t.isDraft=!1,t.isPublished=!1,t.isDeprecated=!1,"published"==t.state?t.isPublished=!0:"draft"==t.state?t.isDraft=!0:"deprecated"==t.state&&(t.isDeprecated=!0),t.readable_date="--.--.----",void 0!==t.date&&""!=t.date&&null!=t.date){var e=new Date(1e3*parseInt(t.date));t.readable_date=e.getDate()+"."+(e.getMonth()+1)+"."+e.getFullYear()+" &bull; "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}void 0!==t.editor&&""!=t.editor&&null!==t.editor||(t.editor="unknown")})),this.$list.html(a.a.tpl_revisions({revisions:t,lang_values:document.lang_values}));var e=this.$list.children().length*this.$list.children().last().outerWidth(!0);return this.$list.css("width",e),this},onRevisionsScroll:function(){if(-1!=this.collection.nextpage&&this.$el.is(":visible")){var t=this.$list.outerWidth(!0)-Math.abs(this.$list.position().left);(t-=this.$el.outerWidth(!0))<300&&this.collection.fetch({page:this.collection.nextpage})}},onPreview:function(t){var e=jQuery(t.target).parents(".grid-revision"),n=GRID.PREVIEW_PATTERN.replace("{REV}",e.data("revision"));window.open(n,"_blank"),this.$el.parents(".rev-wrapper").toggle()},onDelete:function(t){if(!GRID.getRights().get("revert")||GRID.locked())return alert("You have no rights for that..."),!1;GRID.revert()},onRevert:function(t){if(!GRID.getRights().get("revert")||GRID.locked())return alert("You have no rights for that..."),!1;var e=jQuery(t.target).parents(".grid-revision").data("revision");GRID.setToRevision(e)}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridToolbarView=i.a.View.extend({id:"grid-toolbar",_toolContainersView:null,_toolBoxesView:null,_revisionsView:null,events:{"click .grid-toolbar [role=publish]":"publish","click .grid-toolbar [role=preview]":"preview","click .grid-toolbar [role=revert]":"revert","click .grid-toolbar [role=revisions]":"revisions","click .grid-toolbar [role=authors]":"onClickAuthors","click .grid-element-type[data-type=box]:not(.active)":"showBoxTools","click .grid-element-type[data-type=container]:not(.active)":"showContainerTools"},initialize:function(){this.listenTo(this.model,"change:isDraft",this.setState),this.listenTo(GRID.authors,"add",this.onUpdateAuthors),this.listenTo(GRID.authors,"remove",this.onUpdateAuthors),this.listenTo(GRID.authors,"reset",this.onUpdateAuthors),this.setState()},render:function(){this.$el.html(a.a.tpl_toolbar(this.model.toJSON())),this.$toolbar=this.$el.find(".grid-toolbar"),this.$tool_elements=this.$el.find(".grid-tool-elements"),this.$tool_element_content=this.$el.find(".grid-element-type-content"),this.$tab_container=this.$el.find(".grid-element-type[data-type=container]"),this.$tab_box=this.$el.find(".grid-element-type[data-type=box]"),this.$element_trash=this.$el.find(".grid-element-trash"),this.$authors_count=this.$el.find(".indicator-authors-count"),"grid"==GRID.mode&&(this._revisionsView=new GridRevisionsView({collection:GRID.revisions}),this.$el.append(this._revisionsView.$el.hide()));var t="container";return"container"!=GRID.mode&&GRID.getRights().get("create-container")||(this.$tab_container.remove(),t="box"),GRID.getRights().get("create-box")||(this.$tab_box.remove(),t=!1),"container"==t?this.showContainerTools():"box"==t&&this.showBoxTools(),this.onUpdateAuthors(),this},publish:function(){if(!GRID.getRights().get("publish")||GRID.locked())return alert("You have no rights for that..."),!1;this.model.save()},setState:function(){var t=this.model.get("isDraft");this.$el.find(".grid-toolbar").attr("data-draft",t);var e=this.$el.find(".grid-tool-state span");t?e.html("Draft"):e.html("Published")},preview:function(){window.open(this.model.get("PREVIEW_URL"),"grid_preview")},revert:function(){if(!GRID.getRights().get("revert")||GRID.locked())return alert("You have no rights for that..."),!1;GRID.revert()},revisions:function(){this._revisionsView.$el.slideToggle(),jQuery("html, body").animate({scrollTop:0},300)},toggleBoxes:function(){GRID.log("BTN toggleBoxes")},getToolContainersView:function(){return this._toolContainersView instanceof GridToolContainersView||(this._toolContainersView=new GridToolContainersView({collection:GRID.getContainerTypes()})),this._toolContainersView},containerToolsVisible:function(){return 1==this.$el.find(this.getToolContainersView().el).length},toggleContainerTools:function(){this.hideBoxTools(),this.containerToolsVisible()?this.hideContainerTools():this.showContainerTools()},showContainerTools:function(){this.hideBoxTools(),this.containerToolsVisible()||(this.$el.find(this.getToolContainersView().el).remove(),this.$el.find(".grid-element-type-content").append(this.getToolContainersView().render().el),this.$tab_container.addClass("active"))},hideContainerTools:function(){this.containerToolsVisible()&&(this.$el.find(this.getToolContainersView().el).remove(),this.$tab_container.removeClass("active"))},getToolBoxesView:function(){return this._toolBoxesView instanceof GridToolBoxTypesView||(this._toolBoxesView=new GridToolBoxTypesView({collection:GRID.getBoxTypes()})),this._toolBoxesView},boxToolsVisible:function(){return 1==this.$el.find(this.getToolBoxesView().el).length},toggleBoxTools:function(){this.hideContainerTools(),this.boxToolsVisible()?this.hideBoxTools():this.showBoxTools()},showBoxTools:function(){this.hideContainerTools(),this.boxToolsVisible()||(this.$el.find(".grid-element-type-content").append(this.getToolBoxesView().render().el),this.$tab_box.addClass("active"))},hideBoxTools:function(){this.boxToolsVisible()&&(this.$tab_box.removeClass("active"),this.$el.find(this.getToolBoxesView().el).remove())},onResize:function(){var t=jQuery(window).height()-this.$el.offset().top-this.$tab_container.outerHeight();this.$tool_element_content.css("height",t),this.trigger("toolbar_resize",t)},onUpdateAuthors:function(){GRID.authors.getCount()<2?this.$authors_count.parents("li").hide():(this.$authors_count.parents("li").show(),this.$authors_count.text(GRID.authors.getCount())),this.$toolbar.removeClass("async-request-lock");var t=this;GRID.authors.each((function(e){e.get("request_lock")&&t.$toolbar.addClass("async-request-lock")}))},onClickAuthors:function(t){GRID.toggleAuthors(),this.$toolbar.removeClass("async-request-lock")},async_request_lock:function(){this.$toolbar.addClass("async-request-lock")}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridToolContainersView=i.a.View.extend({className:"grid-tool grid-element-container",events:{"click .grid-container-type":"renderContainerType"},render:function(){return this.$el.empty(),this.$el.append(a.a.tpl_toolContainers({})),this.delegateEvents(),this},renderContainerType:function(t){var e=jQuery(t.currentTarget);e.toggleClass("active");var n=e.attr("role"),r="";if("reusable"===n){var i=this.getReusable();r=this.getRenderedContainerList(i)}else{var o=this.getContainers(n);r=this.getRenderedContainerList(o)}return e.hasClass("active")?e.next("dd").append(r):e.next("dd").empty(),this.initializesDraggable(),this},getRenderedContainerList:function(t){return a.a.tpl_toolContainersContainer(t)},getContainers:function(t){var e=this.collection,n={containers:this.collection.toJSON()};return o.default.each(n.containers,(function(t,r,i){if(0!==t.type.indexOf("c-"))delete n.containers[r];else{t.slots=[];for(var o=e.at(r).getDimension().split("-"),s=0;s<t.numslots;s++)t.slots.push({dimension:o[s]})}})),n},getReusable:function(){return{containers:GRID.getReusableContainers().toJSON()}},initializesDraggable:function(){return jQuery(this.el).find(".grid-new-element").draggable({helper:function(t,e){return jQuery("<div class='dragger-helper'></div>")},cursorAt:{left:30,top:30},zIndex:99,appendTo:GRID.getView().$el,scroll:!0,start:function(t,e){GRID.log("Start dragging");jQuery;var n=GRID.getView().$el,r=n.find(".grid-container"),i=jQuery(document.createElement("div")).addClass("container-drop-area-wrapper").attr("data-type","container-drop-area-wrapper");n.find(".containers-wrapper").prepend(i.clone()),r.after(i.clone()),n.find(".container-drop-area-wrapper").append(jQuery(document.createElement("div")).addClass("container-drop-area")),n.find(".container-drop-area").droppable({accept:".grid-new-element",hoverClass:"hover",drop:function(t,e){var n=jQuery(e.draggable),r=n.data("reusable"),i=n.data("type"),o=jQuery(this).parent();o.removeClass("container-drop-area-wrapper").addClass("new-container-target"),GRID.getView().$el.find(".container-drop-area-wrapper").remove();var s=o.index();if(1==r||"true"==r){var a=GRID.getReusableContainers().at(n.index());return GRID.getModel().addReuseContainer(a,s),void GRID.log(["REUSED",a])}GRID.getModel().createContainer(i,s)}})},stop:function(t,e){GRID.getView().$el.find(".container-drop-area-wrapper").remove()}}),this}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridToolBoxTypesView=i.a.View.extend({className:"grid-tool grid-element-box",events:{"click .grid-box-type":"toggleBoxType"},render:function(){this.$el.empty();var t={boxtypes:[]};return this.collection.each((function(e,n){var r=e.toJSON();r.index=n,t.boxtypes.push(r)})),this.$el.append(a.a.tpl_toolBoxes(t)),this.delegateEvents(),this},toggleBoxType:function(t){var e=jQuery(t.currentTarget);if(e.toggleClass("active"),e.hasClass("active")){var n=new GridToolBoxBlueprintsView({model:this.collection.at(e.data("index"))});e.next("dd").append(n.render().el)}else e.next("dd").empty()}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridToolBoxBlueprintsView=i.a.View.extend({className:"grid-box-blueprints",timer:null,blueprints:null,events:{"keyup .grid-box-blueprints-search input":"searchString"},render:function(){if(this.blueprints=this.model.getBlueprints(),this.box_type=this.model.get("type"),this.listenTo(this.blueprints,"add",this.addBlueprintBox),this.model.searchBoxes(),this.delegateEvents(),this.model.get("criteria").length>0){var t=jQuery('<div class="grid-box-blueprints-search"><input placeholder="Which do you need?" type="text" value="" /></div>');this.$el.append(t),this.searchString({target:t.find("input")})}return this.$blueprintslist=jQuery("<div class='grid-box-blueprints-list'></div>"),this.$el.append(this.$blueprintslist),this},addBlueprintBox:function(t,e,n){var r=t.toJSON();return r.cid=t.cid,r.reusable="reference"==this.box_type,this.$blueprintslist.append(a.a.tpl_toolBoxesBlueprint(r)),this.initializesDraggable(),this},searchString:function(t){var e=jQuery(t.target).val(),n=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){n.stopListening(n.blueprints),n.blueprints=n.model.search(e,n.model.criteria),n.$blueprintslist.empty(),n.listenTo(n.blueprints,"add",n.addBlueprintBox)}),300)},initializesDraggable:function(){var t=this;return jQuery(this.el).find(".grid-box-dragger").draggable({helper:function(t,e){return jQuery("<div class='dragger-helper'></div>")},cursorAt:{left:30,top:30},zIndex:199,appendTo:GRID.getView().$el,addClass:!0,start:function(e,n){jQuery;var r=jQuery(GRID.getView().el).find(".grid-container-type-c[data-reused=false] .grid-slot .grid-boxes-wrapper, .grid-container-type-sc .grid-slot .grid-boxes-wrapper");GRID.log(r),r.children(".grid-box").before(jQuery(document.createElement("div")).addClass("grid-box-drop-area-wrapper")),r.append(jQuery(document.createElement("div")).addClass("grid-box-drop-area-wrapper")),r.find(".grid-box-drop-area-wrapper").append(jQuery(document.createElement("div")).addClass("grid-box-drop-area")),r.find(".grid-box-drop-area").droppable({accept:".grid-box-dragger",hoverClass:"hover",drop:function(e,n){var r=jQuery(n.draggable),i=jQuery(this),o=i.parents(".grid-slot"),s=o.parents(".grid-container"),a=GRID.getModel().getContainers().get(s.data("id")).getSlots().get(o.data("id")),u=t.blueprints.get(r.data("cid")),c=i.parent().addClass("grid-new-box-place").removeClass("grid-box-drop-area-wrapper");GRID.getView().$el.find(".grid-box-drop-area-wrapper").remove();a.createBox(u,c.index())}})},stop:function(t,e){GRID.getView().$el.find(".grid-box-drop-area-wrapper").remove()}}),this}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridSlotStyleChangerView=i.a.View.extend({className:"grid-slot-style-changer style-changer",tagName:"div",events:{"click li":"changeStyle"},initialize:function(){this.listenTo(GRID.getSlotStyles(),"add",this.render)},render:function(){var t=[],e="Default Style",n=this;GRID.getSlotStyles().each((function(r){r.get("slug")==n.model.get("style")&&(e=r.get("title")),t.push(r.toJSON())}));var r=this.model.getContainer();return this.$el.html(a.a.tpl_slotstylechanger({styles:t,activestyle:e,reused:r.get("reused")})),this},changeStyle:function(t){this.model.set("style",jQuery(t.target).attr("data-style")),this.model.save()}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.Authors=i.a.View.extend({className:"grid-authors",initialize:function(){this.listenTo(GRID.authors,"add",this.onAddAuthor),this.listenTo(GRID.authors,"remove",this.render),this.listenTo(GRID.authors,"reset",this.render),this.listenTo(GRID.authors,"change",this.render)},render:function(){this.$el.empty(),this.$el.append(a.a.tpl_authors()),this.$list=this.$el.find(".authors-list");var t=this;return GRID.authors.each((function(e){t.onAddAuthor(e)})),this},onResize:function(t){this.$list.css("height",t+"px")},onAddAuthor:function(t){t=new Author({model:t});this.$list.append(t.render().$el)}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.Author=i.a.View.extend({tagName:"li",className:"grid-author",events:{"click .author-lock-sender":"onClickSendLock","click .author-lock-requester":"onClickRequestLock"},initialize:function(){this.listenTo(this.model,"change:request_lock",this.onRequestLock)},render:function(){var t=this.model.toJSON();return t.have_lock=GRID.authors.haveLock(),this.$el.empty(),this.$el.append(a.a.tpl_author(t)),this.onRequestLock(),this},onClickSendLock:function(){GRID.async.locking_handover(this.model.get("id"))},onClickRequestLock:function(){GRID.async.locking_request_lock()},onRequestLock:function(){this.model.get("request_lock")?this.$el.addClass("async-request-lock"):this.$el.removeClass("async-request-lock")}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.ContainerType=i.a.Model.extend({getDimension:function(){var t="",e=0;return o.default.each(this.get("type").split("-"),(function(n,r,i){0!=n&&0!=e++&&(t+="-"+n)})),t.substring(1)},getType:function(){return this.get("type").split("-")[0]}}),window.BoxType=i.a.Model.extend({defaults:function(){return{type:null,criteria:null,blueprints:null}},getBlueprints:function(){return this.blueprints instanceof GridBoxBlueprints||(this.blueprints=new GridBoxBlueprints),this.blueprints},searchBoxes:function(){GRID.log(["BoxType->searchBoxes",this]);var t=this.getBlueprints();return t.fetch({type:this.get("type"),criteria:this.get("criteria"),searchString:""}),this.set("blueprints",t),t},search:function(t,e){var n=new GridBoxBlueprints;return n.fetch({type:this.get("type"),criteria:e,searchString:t}),n}}),window.StyleType=i.a.Model.extend({}),window.Revision=i.a.Model.extend({initialize:function(t){this.set("id",t.revision)}}),window.Grid=i.a.Model.extend({defaults:function(){return{id:-1,DEBUGGING:!1,SERVER:"/grid_ajax_endpoint",PREVIEW_URL:window.location.pathname+"/preview",isDraft:!0}},getGridID:function(){return GRID.ID},initialize:function(t){if(!t||!t.id)throw"InvalidConstructArgs";this.fetch({success:t.fn_success})},createContainer:function(t,e,n){var r=this,i=new Container({type:t,parent:this});void 0===n?i.set("reused",!1):i.set("reused",n),i.save(null,{index:e,action:"create",success:function(t,n,i){GRID.log("CreateContainerSuccess::"),GRID.log([t,n,i]),r.addContainer(t,e)},error:function(t,e,n){GRID.log("CreateContainerror::"),GRID.log([t,e,n])}})},addContainer:function(t,e){if(!(t instanceof Container))throw"Try to add an not Container Object: Grid.addContainer";var n={};"number"==typeof e&&(n.at=e),t.set("parent",this),this.getContainers().add(t,n)},addReuseContainer:function(t,e){var n=this;return GridRequest.grid.addReuseContainer(t,e,(function(t){n.addContainer(new Container(t.result),e)})),this},getContainers:function(){return this.get("collection_containers")||this.set("collection_containers",new Containers),this.get("collection_containers")},getContainer:function(t){return this.getContainers().at(t)},moveBox:function(t,e,n){GridRequest.grid.moveBox(t,e,n,(function(r){var i=t.clone();t.getSlot().getBoxes().remove(t),e.addBox(i,n)}))},duplicateBox:function(t,e){var n=t.clone();GridRequest.box.create(n,{index:e,success:function(){n.setDuplicated(),t.getSlot().addBox(n,e)}})},checkIsDraft:function(){GridRequest.grid.read(this,{action:"checkdraft"})},sync:function(t,e,n){"function"==typeof GridRequest.grid[t]?GridRequest.grid[t](e,n):GRID.log("grid sync metod not defined "+t)}}),window.Container=ContainerType.extend({getGrid:function(){return this.get("parent")},getGridID:function(){return this.get("parent").getGridID()},initialize:function(t){this.setSlots(t.slots),this.set("left_space",this.getSpace("left")),this.set("right_space",this.getSpace("right"))},getSpace:function(t){void 0===t&&(t="left");var e=this.get("space_to_"+t);if(""==e||null==e)return 0;var n=e.split("d");return n[0]/n[1]},getIndex:function(){return this.get("parent").getContainers().indexOf(this)},setSlots:function(t){this.getSlots().reset();var e=this,n=this.getDimension().split("-"),r=0;o.default.each(t,(function(t){t.dimension=n[r++],e.addSlot(new Slot(t))}))},addSlot:function(t,e){if(!(t instanceof Slot))throw"Try to add an not Slot Object: Container.addSlot";var n={};"number"==typeof e&&(n.at=e),t.set("parent",this),this.getSlots().add(t,n)},getSlots:function(){return this.get("collection_slots")||this.set("collection_slots",new Slots),this.get("collection_slots")},getSlot:function(t){return this.getSlots().at(t)},sync:function(t,e,n){GridRequest.container[t](e,n)}}),window.Slot=i.a.Model.extend({getGrid:function(){return this.get("parent").getGrid()},getGridID:function(){return this.get("parent").getGridID()},getContainer:function(){return this.get("parent")},initialize:function(t){var e=this;GRID.log("init Slot"),GRID.log(t),o.default.each(t.boxes,(function(t){GRID.log("add Box"),e.addBox(new Box(t))}))},createBox:function(t,e){var n=this,r=t.toJSON();r.parent=this,new Box(r).save(null,{index:e,success:function(t,r,i){GRID.log("CreateboxSuccess::"),GRID.log([t,r,i]),n.addBox(t,e)},error:function(t,e,n){GRID.log("Createboxrror::"),GRID.log([t,e,n])}})},addBox:function(t,e){if(!(t instanceof Box))throw"Try to add an not Box Object: Slot.addBox";var n={};"number"==typeof e&&(n.at=e),t.set("parent",this),this.getBoxes().add(t,n)},getBoxes:function(){return this.get("collection_boxes")||this.set("collection_boxes",new Boxes),this.get("collection_boxes")},getBox:function(t){return this.getBoxes().at(t)},sync:function(t,e,n){GridRequest.slot[t](e,n)}}),window.Box=i.a.Model.extend({unsetDuplicated:function(){this.unset("isDuplicated")},setDuplicated:function(){this.set("isDuplicated",!0)},isDuplicated:function(){return!0===this.get("isDuplicated")},getGrid:function(){return this.get("parent").getGrid()},getGridID:function(){return this.get("parent").getGridID()},getSlot:function(){return this.get("parent")},getContainer:function(){return this.getSlot().getContainer()},initialize:function(t){},getIndex:function(){return this.get("parent").getBoxes().indexOf(this)},duplicate:function(){this.getGrid().duplicateBox(this,this.getIndex()+1)},sync:function(t,e,n){GridRequest.box[t](e,n)}}),window.GridBoxBlueprint=i.a.Model.extend({initialize:function(t){if(!t||!t.type||""==t.type)throw"InvalidConstructArgs GridBoxBlueprint: needs type";if(!t.content||"object"!=y(t.content))throw"InvalidConstructArgs GridBoxBlueprint: needs content"}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridRights=i.a.Model.extend({initialize:function(t){},setNoRights:function(){var t=this;o.default.each(this.attributes,(function(e,n,r){t.set(n,!1)}))},logRights:function(){o.default.each(this.attributes,(function(t,e,n){GRID.log(e+" "+t)}))},sync:function(t,e,n){GridRequest.rights(e,n)}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridAuthor=i.a.Model.extend({defaults:function(){return{has_lock:!1,request_lock:!1}},initialize:function(t){if(!t)throw"No parameters in constructor of author";if(!t.id)throw"InvalidConstructArgs GridAuthor needs id";if(!t.name)throw"InvalidConstructArgs GridAuthor needs name"}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.Revisions=i.a.Collection.extend({model:Revision,initialize:function(t){if(!(t&&t.grid&&t.grid instanceof Grid))throw"InvalidConstructArgs Revisions need a Grid";this.grid=t.grid},getGridID:function(){return GRID.log(this),this.grid.getGridID()},sync:function(t,e,n){GridRequest.revisions(e,n)}}),window.ContainerTypes=i.a.Collection.extend({model:ContainerType,sync:function(t,e,n){GridRequest.containertypes(e,n)}}),window.ReusableContainers=i.a.Collection.extend({model:ContainerType,sync:function(t,e,n){GridRequest.reusablecontainers(e,n)}}),window.BoxTypes=i.a.Collection.extend({model:BoxType,sync:function(t,e,n){GridRequest.boxtypes(e,n)}}),window.Styles=i.a.Collection.extend({model:StyleType,initialize:function(t){if(!t||!t.type)throw"InvalidConstructArgs Styles";this.type=t.type},sync:function(t,e,n){GridRequest.styles(e,n)}}),window.Containers=i.a.Collection.extend({model:Container,move:function(t,e){var n=this;return GridRequest.container.update(t,{action:"move",index:e,success:function(r){n.remove(t),n.add(t,{at:e})}}),this}}),window.Slots=i.a.Collection.extend({model:Slot}),window.Boxes=i.a.Collection.extend({model:Box}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridBoxBlueprints=i.a.Collection.extend({model:GridBoxBlueprint,initialize:function(t){},sync:function(t,e,n){GridRequest.boxblueprints(e,n)}}),
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/
window.GridAuthors=i.a.Collection.extend({model:GridAuthor,async_authors_list:function(t){var e=this;o.default.each(t,(function(t){e.add({id:t.identifier,name:t.author})}))},resetLock:function(){this.each((function(t){t.set("has_lock",!1)}))},setLock:function(t){this.get(t).set("has_lock",!0)},haveLock:function(){return void 0===this.findWhere({has_lock:!0})},getCount:function(){return this.length+1},async_authors_joined:function(t){this.add({id:t.identifier,name:t.author})},async_authors_left:function(t){this.remove(this.get(t))},async_disconnect:function(){this.reset(),this.resetLock()}}),window.GridAjax=function(t,e,n){var r={};r.method=t,r.params=e,"object"!=v(n)&&(n={}),void 0===n.checkIsDraft&&(n.checkIsDraft=!0),this.settings={url:GRID.SERVER,async:!0,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",error:function(e,r,i){GRID.finishLoading(),GRID.DEBUGGING&&(GRID.log(e.responseText),jQuery(".error-messages").html("Method: "+t+"<br>Status: ("+e.status+") -> "+r+"<br>ResponseText: <br><pre>"+e.responseText+"</pre>").show()),"function"==typeof n.error_fn&&n.error_fn(e,r,i)},beforeSend:function(t,e){GRID.startLoading()},success:function(t,e,r){GRID.finishLoading(),GRID.log(["AJAX Success",n]),"function"==typeof n.success_fn&&n.success_fn(t,e,r),1==n.checkIsDraft&&(GRID.getModel().checkIsDraft(),GRID.revisions.fetch())},data:JSON.stringify(r),wait:!1},jQuery.extend(!0,this.settings,n),this.send=function(){jQuery.ajax(this.settings)},this.settings.wait||this.send()},window.GridRequest={grid:{create:function(t,e){GRID.log("Request grid create")},read:function(t,e){switch(GRID.log("Grid->update "+e.action),e.action){case"checkdraft":new GridAjax("checkDraftStatus",[t.getGridID()],{success_fn:function(e){t.set("isDraft",e.result)},checkIsDraft:!1});break;default:new GridAjax("loadGrid",[t.getGridID()],{success_fn:function(n){t.attributes=o.default.extend(t.attributes,n.result),t.getContainers().reset(),o.default.each(n.result.container,(function(e){GRID.log("Add new Container"),t.addContainer(new Container(e))})),e.success(),e.reverted&&GRID.flash()}})}},update:function(t,e){switch(GRID.log("Grid->update"),e.action){case"revertDraft":new GridAjax("revertDraft",[t.getGridID()],{success_fn:function(e){GRID.log(["revertDraft success",e]),t.fetch()}});break;case"setToRevision":var n=[t.getGridID(),e.revision];new GridAjax("setToRevision",n,{success_fn:function(e){GRID.log("setToRevision success"),GRID.log(e),t.fetch({reverted:!0})}});break;default:new GridAjax("publishDraft",[t.getGridID()],{success_fn:function(e){GRID.log("publishDraft success"),GRID.log(e),t.set("isDraft",!1)}})}},moveBox:function(t,e,n,r){var i=[t.getGridID(),t.getContainer().get("id"),t.getSlot().get("id"),t.getIndex(),e.getContainer().get("id"),e.get("id"),n];new GridAjax("moveBox",i,{success_fn:r})},addReuseContainer:function(t,e,n){var r=[GRID.ID,e,t.get("id")];new GridAjax("addReuseContainer",r,{success_fn:n})},destroy:function(t,e){GRID.log("Grid->destroy")}},revisions:function(t,e){GRID.log("revisions->read");var n="undefined"!=v(e.page)?e.page:0;t.nextpage=-1,new GridAjax("getGridRevisions",[t.getGridID(),n],{success_fn:function(e){GRID.log("getGridRevisions succes"),e.result.length>0&&(t.nextpage=n+1),0==n&&t.reset(),o.default.each(e.result,(function(e){t.add(new Revision(e))}))},checkIsDraft:!1})},containertypes:function(t,e){GRID.log("Containertypes->read"),new GridAjax("getContainerTypes",[GRID.ID],{success_fn:function(e){GRID.log("getContainerTypes succes"),GRID.log(e),t.reset(),o.default.each(e.result,(function(e){t.add(new ContainerType(e))}))},checkIsDraft:!1})},reusablecontainers:function(t,e){new GridAjax("getReusableContainers",[GRID.ID],{success_fn:function(e){GRID.log(["reusablecontainers data",e]),o.default.each(e.result,(function(e){t.add(new ContainerType(e))}))},checkIsDraft:!1})},boxtypes:function(t,e){GRID.log("Boxtypes->read"),new GridAjax("getMetaTypesAndSearchCriteria",[GRID.ID],{success_fn:function(e){GRID.log("getMetaTypesAndSearchCriteria succes"),GRID.log(e),o.default.each(e.result,(function(e){t.add(new BoxType(e))}))},checkIsDraft:!1})},boxblueprints:function(t,e){var n=[GRID.ID,e.type,e.searchString,e.criteria];GRID.log(["blueprints",t,e,n]),new GridAjax("Search",n,{success_fn:function(e){GRID.log(["blueprints search",e]),o.default.each(e.result,(function(e,n,r){var i=new GridBoxBlueprint(e);t.add(i)}))},checkIsDraft:!1})},styles:function(t,e){GRID.log(t.type+"Styles->read"),new GridAjax("get"+t.type+"Styles",[],{success_fn:function(e){GRID.log("get"+t.type+"Styles succes"),GRID.log(e),t.reset(),o.default.each(e.result,(function(e){t.add(new StyleType(e))}))},checkIsDraft:!1})},rights:function(t,e){GRID.log("Rights->read"),new GridAjax("Rights",[],{success_fn:function(n){GRID.log(["rights",n]),o.default.each(n.result,(function(e,n,r){t.set(e,!0)})),v(e)==v({})&&"function"==typeof e.success&&e.success(n)},checkIsDraft:!1})},container:{create:function(t,e){GRID.log("Container->create");var n=[t.getGridID(),t.get("type"),e.index];GRID.log(n),new GridAjax("addContainer",n,{success_fn:function(n){GRID.log("addContainer success"),GRID.log(n),t.set("id",n.result.id),t.set("slots",n.result.slots),t.set("style",n.result.style),t.set("space_to_right",n.result.space_to_right),t.set("space_to_left",n.result.space_to_left),t.setSlots(n.result.slots),e.success()}})},read:function(t,e){GRID.log("Container->read")},update:function(t,e){switch(GRID.log("Container->update"),e.action){case"reuse":var n=[t.getGridID(),t.get("id"),e.reusetitle];new GridAjax("reuseContainer",n,{success_fn:function(n){t.set("reused",!0),e.success(n)},checkIsDraft:!1});break;case"move":n=[t.getGridID(),t.get("id"),e.index];new GridAjax("moveContainer",n,{success_fn:e.success});break;default:var r=o.default.clone(t.attributes);delete r.slots,delete r.collection_slots,delete r.classes,delete r.parent;n=[t.getGridID(),t.get("id"),r];GRID.log(n),new GridAjax("updateContainer",n,{success_fn:function(t){e.success()},error_fn:e.error})}},delete:function(t,e){var n=[t.getGridID(),t.get("id")];GRID.log(n),new GridAjax("deleteContainer",n,{success_fn:function(n){GRID.getModel().getContainers().remove(t),e.success()}})}},slot:{create:function(t,e){GRID.log("slot->create")},read:function(t,e){GRID.log("slot->read")},update:function(t,e){GRID.log("slot->update");var n=[t.getGridID(),t.get("parent").get("id"),t.get("id"),t.get("style")];GRID.log(n),new GridAjax("updateSlotStyle",n,{success_fn:function(t){GRID.log("updateSlotStyle success"),e.success()}})},delete:function(t,e){GRID.log("slot->destroy")}},box:{create:function(t,e){GRID.log("box->create");var n=[t.getGridID(),t.getContainer().get("id"),t.getSlot().get("id"),e.index,t.get("type"),t.get("content")];new GridAjax("createBox",n,{success_fn:function(n){GRID.log("createBox success"),GRID.log(n),t.set("id",n.result.id),e.success()}})},read:function(t,e){GRID.log("box->read");var n=[t.getGridID(),t.getContainer().get("id"),t.getSlot().get("id"),t.getIndex()];GRID.log(n),new GridAjax("fetchBox",n,{success_fn:function(e){GRID.log("fetchBox success"),GRID.log(e),t.attributes=o.default.extend(t.attributes,e.result),t.trigger("change")},checkIsDraft:!1})},update:function(t,e){switch(GRID.log("box->update "+e.action),e.action){case"reuse":var n=[t.getGridID(),t.getSlot().getContainer().get("id"),t.getSlot().get("id"),t.getIndex()];GRID.log(n),new GridAjax("reuseBox",n,{success_fn:function(e){t.attributes=e.result,t.trigger("change")},checkIsDraft:!1});break;case"move":break;default:var r=o.default.clone(t.attributes);GRID.log("attributes"),GRID.log(r),delete r.classes,delete r.contentstructure,delete r.parent;n=[t.getGridID(),t.getSlot().getContainer().get("id"),t.getSlot().get("id"),t.getIndex(),r];GRID.log(n),new GridAjax("UpdateBox",n,{success_fn:function(n){GRID.log("UpdateBox success"),GRID.log(n),e.success(),t.fetch()}})}},delete:function(t,e){GRID.log("box->destroy");var n=[t.getGridID(),t.getContainer().get("id"),t.getSlot().get("id"),t.getIndex()];GRID.log(n),new GridAjax("removeBox",n,{success_fn:function(t){GRID.log("removeBox success"),GRID.log(t),e.success()}})}}};var b=n(30),w=n.n(b);function _(){var t=this;this.domain=document.grid.async.domain,this.path=document.grid.async.path,this.author=document.grid.async.author,this.timeout=document.grid.async.timeout,this.observers=[],this.browser_identifier=window.localStorage.getItem("grid_browser_identifier"),null==this.browser_identifier&&(this.browser_identifier=Math.random().toString(36).substring(7),window.localStorage.setItem("grid_browser_identifier",this.browser_identifier)),this.last_time=(new Date).getTime(),this._onIdleInterval=function(){(new Date).getTime()-t.last_time>=1e3*this.timeout&&GRID.authors.length>0&&GRID.authors.haveLock()&&window.location.reload(!0)};setInterval((function(){t._onIdleInterval()}),1e3);this._onActivity=function(){t.last_time=(new Date).getTime()},jQuery("body").on("mousemove",(function(){t._onActivity()})).on("keypress",(function(){t._onActivity()})),this.init=function(){""!=document.grid.async.service&&(this.socket=w()(document.grid.async.service),this.initEvents())},this.addObserver=function(t){this.observers.push(t)},this.removeObserver=function(t){this.observers=o.default.without(this.observers,t)},this.notifyAll=function(t,e){o.default.each(this.observers,(function(n,r,i){"function"==typeof n["async_"+t]&&n["async_"+t](e)}))},this.initEvents=function(){this.on("connect","connect"),this.on("disconnect","disconnect"),this.on("authors.list","authors_list"),this.on("authors.joined","authors_joined"),this.on("authors.left","authors_left"),this.on("authors.multiplehits","authors_multihit"),this.on("locking.isLocked","locking_is_locked"),this.on("locking.lockRequested","locking_lock_requested"),this.on("ping.send","ping_send")},this.on=function(t,e){var n=this;this.socket.on(t,(function(t){n[e](t)}))},this.connect=function(t){this.authors_join()},this.disconnect=function(t){this.notifyAll("disconnect"),this.notifyAll("locking_is_locked")},this.authors_join=function(){this.socket.emit("authors.join",{domain:this.domain,path:this.path,author:this.author,identity:this.browser_identifier})},this.locking_request_lock=function(){this.socket.emit("locking.requestLock")},this.locking_handover=function(t){GRID.authors.each((function(t){t.set("request_lock",!1)})),this.socket.emit("locking.handover",t)},this.locking_deny_handover=function(t){this.socket.emit("locking.denyHandover",t)},this.authors_list=function(t){this.notifyAll("authors_list",t)},this.authors_joined=function(t){this.notifyAll("authors_joined",t)},this.authors_left=function(t){this.notifyAll("authors_left",t)},this.authors_multihit=function(t){alert("You have opened this grid on "+t+" browser windows. As parallel editing is not allowed you're locked out here.")},this.locking_is_locked=function(t){GRID.authors.resetLock(),t.isLocked&&GRID.authors.setLock(t.identifier),this.notifyAll("locking_is_locked")},this.locking_lock_requested=function(t){var e=GRID.authors.get(t.identifier);e instanceof GridAuthor&&e.set("request_lock",!0),this.notifyAll("request_lock")};this.ping_send=function(){t.socket.emit("ping.received")}}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/**
* @author Palasthotel <rezeption@palasthotel.de>
* @copyright Copyright (c) 2014, Palasthotel
* @license http://www.gnu.org/licenses/gpl-2.0.html GPLv2
* @package Palasthotel\Grid
*/!function(){for(var t,e=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],r=n.length,i=window.console=window.console||{};r--;)i[t=n[r]]||(i[t]=e)}(),window.GRID={};var C=window.GRID={$body:null,dom_root:"#new-grid-wrapper",$root:null,dom_root_editor:"#new-grid-editor-wrapper",$root_editor:null,dom_root_authors:"#grid-authors-wrapper",$root_authors:null,ID:null,DEBUGGING:!1,SERVER:"/grid_ajax_endpoint",PREVIEW_URL:window.location.pathname+"/preview",PREVIEW_PATTERN:window.location.pathname+"/{REV}/preview",grid:null,gridView:null,types_box:null,types_container:null,reusable_containers:null,styles_container:null,styles_slot:null,styles_box:null,revisions:null,async:null,authors:null,init:function(){if(this._initConstants(),void 0===C.ID||null===C.ID)return!1;C.$loading=a.a.tpl_loading(),this.$root.append(C.$loading),C.$loading.addClass("grid-init-loading"),this.getBoxTypes().fetch(),this.getContainerTypes().fetch(),this.getReusableContainers().fetch(),this.getContainerStyles().fetch(),this.getSlotStyles().fetch(),this.getBoxStyles().fetch(),this.async=new _,this.authors=new GridAuthors,this.async.addObserver(this),this.async.addObserver(this.authors),this.getRights().fetch({success:function(){C.grid=new Grid({id:C.ID,SERVER:C.SERVER,PREVIEW_URL:C.PREVIEW_URL,DEBUGGING:C.DEBUGGING,fn_success:C.new_grid_success})}});var t=this.$body;function e(e){e?t.addClass("is-alt-pressed"):t.removeClass("is-alt-pressed")}return t.on("keydown",(function(t){e(t.altKey)})).on("keyup",(function(t){e(t.altKey)})),this},reload:function(){this.grid.destroy(),this.grid=null,this.$root_authors.empty(),null!=this.gridView&&this.gridView.remove(),this.newGrid()},newGrid:function(){return this.grid=new Grid({id:C.ID,SERVER:this.SERVER,PREVIEW_URL:this.PREVIEW_URL,DEBUGGING:this.DEBUGGING,fn_success:C.new_grid_success}),this},new_grid_success:function(t){C.$root.empty(),C.$root.append(C.$loading),C.gridview=new GridView({model:C.getModel()}),C.gridview.listenTo(C.getRights(),"change",C.onRights),C.$root.append(C.getView().render().el),C._initializeContainerSortable(),C._initializeBoxSortable(),C.revisions=new Revisions({grid:C.getModel()}),C.revisions.fetch(),C.toolbar=new GridToolbarView({model:C.getModel()}),C.async.addObserver(C.toolbar),C.$root.prepend(C.toolbar.render().el),C.$loading.removeClass("grid-init-loading"),C.async.init(),jQuery(window).resize((function(){C.toolbar.onResize()})).trigger("resize")},getModel:function(){return this.grid},getView:function(){return this.gridview},getContainerTypes:function(){return this.types_container instanceof ContainerTypes||(this.types_container=new ContainerTypes),this.types_container},getReusableContainers:function(){return this.reusable_containers instanceof ReusableContainers||(this.reusable_containers=new ReusableContainers),this.reusable_containers},getBoxTypes:function(){return this.types_box instanceof BoxTypes||(this.types_box=new BoxTypes),this.types_box},getContainerStyles:function(){return this.styles_container instanceof Styles||(this.styles_container=new Styles({type:"container"})),this.styles_container},getSlotStyles:function(){return this.styles_slot instanceof Styles||(this.styles_slot=new Styles({type:"slot"})),this.styles_slot},getBoxStyles:function(){return this.styles_box instanceof Styles||(this.styles_box=new Styles({type:"box"})),this.styles_box},getRights:function(){return this.rights instanceof GridRights||(this.rights=new GridRights),this.rights},setToRevision:function(t){C.locked()||GridRequest.grid.update(C.grid,{action:"setToRevision",revision:t})},onRights:function(t){C.log(["onrights",t]),C.getView().render(),C.toolbar.render()},_initConstants:function(){this.$body=jQuery("body"),this.$root=jQuery(this.dom_root),this.$root_editor=jQuery(this.dom_root_editor),this.$root_authors=jQuery(this.dom_root_authors),this.mode=document.gridmode,this.$root.addClass("gridmode-"+this.mode),this.DEBUGGING=document.grid_debug_mode,this.ID=document.ID,this.SERVER="/grid_ajax_endpoint",void 0!==document.gridajax&&null!=document.gridajax&&""!=document.gridajax&&(this.SERVER=document.gridajax),this.PREVIEW_URL=this.PREVIEW_URL.replace("//","/"),"undefined"!=x(document.previewurl)&&null!=document.previewurl&&""!=document.previewurl&&(this.PREVIEW_URL=document.previewurl);var t=window.location.pathname+"/{REV}/preview";"undefined"!=x(document.previewpattern)&&null!=document.previewpattern&&""!=document.previewpattern&&(t=document.previewpattern),this.PREVIEW_PATTERN=t},publish:function(){if(!C.getRights().get("publish")||C.locked())return alert("Sorry you have no rights for that..."),!1;new GridAjax("publishDraft",[C.ID])},revert:function(){C.locked()||GridRequest.grid.update(C.grid,{action:"revertDraft"})},log:function(t){this.DEBUGGING&&console.log(t)},showEditor:function(t){C.$root.animate({width:0},220,(function(){C.$root.hide()})),setTimeout((function(){C.$root_editor.show(),C.$root_editor.animate({width:"100%"},250,(function(){t()})),window.scrollTo(0,0)}),50)},hideEditor:function(t){C.$root_editor.animate({width:"0%"},220,(function(){C.$root_editor.hide()})),setTimeout((function(){C.$root.show(),C.$root.animate({width:"100%"},220,(function(){t()})),window.scrollTo(0,0)}),50)},toggleAuthors:function(){if(""==C.$root_authors.html()){C.$root_authors.empty();var t=new Authors;C.$root_authors.append(t.render().$el),t.listenTo(C.toolbar,"toolbar_resize",t.onResize)}C.$root.toggleClass("is-active-authors"),C.$root_authors.toggleClass("is-active"),C.toolbar.onResize()},showAuthors:function(){this.hideAuthors(),this.toggleAuthors()},hideAuthors:function(){C.$root.removeClass("is-active-authors"),C.$root_authors.removeClass("is-active")},locked:function(){return!C.authors.haveLock()},async_locking_is_locked:function(){C.locked()?(C.$root.addClass("grid-is-locked"),C.showAuthors()):C.$root.hasClass("grid-is-locked")&&(C.reload(),C.$root.removeClass("grid-is-locked"),this.hideAuthors())},async_disconnect:function(){this.async_locking_is_locked()},_initializeContainerSortable:function(){if(!C.getRights().get("move-container")||C.locked())return!1;var t,e;t=!1;jQuery(this.getView().el).sortable({handle:".grid-container-sorthandle, .grid-container-reused-layer",items:".grid-container:not(.grid-container-type-sc)",placeholder:"grid-container-sort-placeholder",pullPlaceholder:!0,appendTo:this.getView().$el,refreshPositions:!0,helper:function(t,e){return jQuery("<div class='dragger-helper'></div>")},cursorAt:{left:30,bottom:30},start:function(n,r){C.log(["container sort START"],n,r);var i=r.item.data("id");jQuery(".grid-element-trash").addClass("grid-active").droppable({accept:".grid-container",hoverClass:"grid-hover",drop:function(n,r){e=C.getModel().getContainers().get(i),t=!0}})},stop:function(n,r){jQuery(".grid-element-trash").removeClass("grid-active"),t&&e.destroy()},update:function(e,n){if(!t){var r=n.item.attr("data-cid"),i=n.item.index(),o=C.getModel().getContainers().get(r);C.getModel().getContainers().indexOf(o);C.getModel().getContainers().move(o,i)}}})},_initializeBoxSortable:function(){if(!C.getRights().get("move-box")||C.locked())return!1;var t,e,n,r,i,o,s,a;s=!1,a=!1,jQuery(this.getView().el).find(".grid-container-type-c[data-reused=false] .grid-boxes-wrapper, .grid-container-type-sc .grid-boxes-wrapper").sortable({items:".grid-box",handle:".grid-box-controls",connectWith:".grid-container-type-c[data-reused=false] .grid-boxes-wrapper, .grid-element-trash",placeholder:"grid-box-sort-placeholder",forcePlaceholderSize:!0,distance:10,refreshPositions:!0,helper:function(t,e){return jQuery("<div class='dragger-helper'></div>")},cursorAt:{left:30,top:30},start:function(r,i){a=!1,s=!1,t=i.item.index(),e=i.item.parents(".grid-slot").data("id"),n=i.item.parents(".grid-container").data("id"),C.log(["START BOX SORT",t,e,n]),jQuery(".grid-element-trash").addClass("grid-active").droppable({accept:".grid-slot .grid-box",hoverClass:"grid-hover",over:function(){s=!0},out:function(){s=!1},drop:function(r,i){C.getModel().getContainers().get(n).getSlots().get(e).getBox(t).destroy(),s=!0}}),jQuery(".grid-element-duplicate").addClass("grid-active").droppable({accept:".grid-slot .grid-box",hoverClass:"grid-hover",over:function(){a=!0},out:function(){a=!1},drop:function(r,i){a=!0;var o=C.getModel().getContainers().get(n).getSlots().get(e).getBox(t);C.getModel().duplicateBox(o,t+1)}})},beforeStop:function(t,e){jQuery(".grid-element-trash").removeClass("grid-active"),jQuery(".grid-element-duplicate").removeClass("grid-active"),(s||a)&&t.preventDefault()},stop:function(s,a){if(o=a.item.parents(".grid-container").data("id"),i=a.item.parents(".grid-slot").data("id"),r=a.item.index(),C.log(["STOP BOX SORT",t,e,n,r,i,o]),n!=o||e!=i||t!=r){var u=C.getModel().getContainers().get(n).getSlots().get(e).getBox(t),c=C.getModel().getContainers().get(o).getSlots().get(i);C.getModel().moveBox(u,c,r)}}})},flash:function(){C.gridview.$el.fadeIn(100).fadeOut(100).fadeIn(100)},startLoading:function(){clearTimeout(C.loading_hide_timeout),C.$loading.show(),C.$loading.addClass("loading")},finishLoading:function(){C.$loading.removeClass("loading"),clearTimeout(C.loading_hide_timeout),C.loading_hide_timeout=setTimeout((function(){C.$loading.hide()}),1200)}};jQuery((function(){C.init()}));n(65)}]);
//# sourceMappingURL=grid-editor.map